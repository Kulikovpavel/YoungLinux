<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Урок 12. Модуль CCK – пакет для конструирования содержания материалов</title>
    <base href="" />
    <link type="text/css" rel="stylesheet" href="http://younglinux.info/misc/print.css" />
      </head>
  <body>
              <div class="section-1">
          
    <div id="node-347" class="section-2">
  <h1 class="book-heading">Урок 12. Модуль CCK – пакет для конструирования содержания материалов</h1>
  <p class="right">Создание сайта на Drupal 6. Практический вводный курс</p>
<p>При создании новой статьи пользователь сайта на Drupal определяет, к какому типу материала она будет относиться. Некоторые материалы, такие как Page и Story, включены изначально, другие активируются при включении соответствующих модулей, например, Book, Blog, Image. Однако ничего не мешает пользователю-администратору создавать собственные типы материалов под какие-нибудь специфические виды статей.</p>
<p>До этого мы видели, что формы редактирования всех типов материалов содержат примерно одинаковые поля: заголовок, меню, содержимое и другое. Хотя, например, тип "Картинки" имеет дополнительное поле для загрузки изображения. Но для какого-нибудь особенного типа материала этих полей может быть недостаточно. Например, может потребоваться поле, где будет указываться уровень статьи, какие-нибудь числовые значения, может потребоваться загрузка нескольких изображений и т.п. </p>
<p>В CMS Drupal можно добавлять собственные поля к материалам, как созданным собственноручно, так и тем, которые активируются при включении модулей. Для создания дополнительных полей используется модуль CCK (Content Construction Kit). Загрузите его с сайта <span class="blue">drupal.org</span>, установите в систему, также загрузите файл перевода с <span class="blue">drupaler.ru</span>.</p>
<p>Перейдите на страницу <span class="monoi">Модули</span> и включите следующие подмодули CCK – <span class="monoi">Content, Option Widgets, Text</span>. Также следует включить подмодуль модуля GeSHi – <span class="monoi">GeSHi field</span>, – который позволяет создавать поле исключительно для программного кода с подсветкой синтаксиса.</p>
<p>Допустим, на нашем сайте будут публиковаться решения задач по программированию. Для подобного материала хорошо бы создать собственный тип (не Story и не блоговую запись), т.к., скорее всего, он потребует поля нестандартного типа. Переходим на страницу <span class="monoi">Управление ? Типы содержимого ? Добавить тип содержимого</span>. В открывшейся форме в поле <span class="monoi">Название</span> вписываем "Задача", а в поле <span class="monoi">Тип</span> - "task", при желании можно заполнить поле описания типа. Далее раскройте раздел <span class="monoi">Свойства формы</span>, в поле <span class="monoi">Название</span> поля текста замените слово "Содержимое" на слово "Пояснение". Сохраните новый тип материала, после чего вы окажетесь на странице <span class="monoi">Управление ? Типы содержимого</span>. </p>
<p>Теперь необходимо настроить поля только что созданного типа. Для этого надо перейти по ссылке <span class="monoi">управлять полями</span> типа материала "Задача". К существующим стандартным полям добавим новое поле, в котором будет указываться язык программирования, на котором решена задача. Внизу страницы есть форма для добавления новых полей. Заполните ее следующим образом: в поле <span class="monoi">Метка</span> впишите "Язык программирования", в <span class="monoi">Имя</span> поля - "lang", тип данных и элемент — текст, текстовая строка. Нажмите на кнопку <span class="monoi">Сохранить</span>, откроются настройки данного поля. Здесь установите флажок <span class="monoi">Обязательный</span> и еще раз сохраните. После этого вы снова окажетесь на странице управления полями типа материала "Задача", где теперь в списке полей появится новое поле.</p>
<p>Следующее поле, которое нам потребуется, будет показывать, решена ли задача или еще нет. Добавляем такое поле: метка - "Задача решена", имя - "solved", тип — текст, элемент — флажки/радиокнопки. В настройках данного поля указываем: обязательный, список допустимых значений — "Да", "Нет" (каждое значение на отдельной строке).</p>
<p>Хотя исходный код решения задачи можно вставить в поле содержимого, но мы создадим специальное поле для кода. Метка - "Исходный код", имя — "source", тип — GeSHi field. Сохраним настройки поля как есть.</p>
<p>Теперь надо правильно выстроить последовательность полей, которую блогеры будут видеть в форме редактирования материала. Поля без проблем можно перемещать относительно друг друга. Расположите поля так, чтобы после <span class="monoi">Параметры меню</span>, сразу следовали поля в следующей последовательности <span class="monoi">Язык программирования, Задача решена, Пояснение, Исходный код</span>. Сохраните изменения.</p>
<p>Далее следует установить разрешения на странице <span class="monoi">Разрешение ролей</span>. Блогеру должно быть позволено create task content, delete own task content, edit own task content.</p>
<p>Кроме того, не забываем, что у нас на сайте поддерживается таксономия. Заходим на страницу таксономии. Здесь два есть два словаря - "Image Galleries" и "Темы". Нас интересует только второй, нажимаем <span class="monoi">изменить словарь</span> и в типах содержимого указываем помимо записи в блог еще и задачу. Сохранив изменения, добавляем еще один термин - "Решение задач". На странице списка терминов узнайте адрес страницы добавленного термина, после чего задайте для нее синоним <span class="blue">taxonomy/term/tasks</span>.</p>
<p>Наконец, создадим материал "Задача" от имени одного из блогеров. Примеры задач есть в архиве к данному курсу (файл tasks.odt). Обратите внимание, для поля  GeSHi field можно выбрать подходящий язык для синтаксической подсветки. Также в данном поле не надо использовать тег code.</p>
<p>После сохранения статьи может не понравиться то, что слова "Pascal" и "Да" расположены ниже заголовков "Язык программирования" и "Задача решена", а не рядом. Чтобы исправить это, перейдите на страницу <span class="monoi">Управление содержимым ? Задача ? Отображение полей</span>. Здесь в столбце <span class="monoi">Метка</span> полей "Язык программирования" и "Задача решена" установите значение <span class="monoi">В линию</span>.</p>
<p>Также можно обособить эти два поля от всего остального текста с помощью объединения их в отдельную группу. Для этого на странице модулей в CCK следует включить подмодуль Fieldgroup. Далее в управлении полями типа "Задача" создать новую группу, например "Информация о задаче" (taskinfo). Потом следует поднять только что созданное поле над полями "Язык программирования" и "Задача решена", а их как бы вставьте внутрь, немного сместив вправо. Чтобы название группы не отображалось, на странице отображения полей поставьте полю "Информация о задаче" метку <span class="monoi">Скрыто</span>.</p>
<p>Добавьте еще несколько задач. Запустите cron, чтобы увидеть ссылку на задачи из облака тегов.</p>
  </div>
    </div>
  </body>
</html>
