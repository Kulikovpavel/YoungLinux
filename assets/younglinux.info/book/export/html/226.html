<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Расширенные свойства перенаправления</title>
    <base href="" />
    <link type="text/css" rel="stylesheet" href="http://younglinux.info/misc/print.css" />
      </head>
  <body>
              <div class="section-1">
                <div class="section-2">
          
    <div id="node-226" class="section-3">
  <h1 class="book-heading">Расширенные свойства перенаправления</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<h2>Использование дескрипторов файла</h2>
<p>Существует три типа I/O (ввода-вывода), которые имеют свои собственные идентификаторы, называемые дескрипторами файла:</p>
<ul>
<li>стандартный ввод: 0</li>
<li>стандартный вывод: 1</li>
<li>стандартная ошибка: 2</li>
</ul>
<p>В следующих описаниях, если номер дескриптора файла не указан, и первый символ перенаправления оператор &lt;, перенаправление ссылается на стандартный ввод (дескриптор файла 0). Если первый символ перенаправления оператор >, перенаправление ссылается на стандартный вывод (дескриптор файла 1).</p>
<p>Некоторые практические примеры внесут больше ясности:</p>
<p><span class="mono">ls > dirlist 2>&amp;1</span></p>
<p>направит как стандартный вывод, так и стандартную ошибку в файл <span class="mono">dirlist</span>, в то время как команда</p>
<p><span class="mono">ls 2>&amp;1 > dirlist</span></p>
<p>направит только стандартный вывод в <span class="mono">dirlist</span>. Это может быть полезным вариантом для программистов.</p>
<p>Существует сложность: не следует путать использование амперсанда здесь с использованием его в <a href="http://younglinux.info/#">разделе "Интерактивные процессы"</a>, где амперсанд используется для запуска процесса в фоновом режиме. В данном случае он просто служит признаком того, что число, которое следует за ним, является не именем файла, а местом, на которое указывается потоку данных. Также отметим, что символ "больше, чем" не должен быть отделен пробелами от номера дескриптора файла. Если он будет отделен, мы снова укажем на вывод в файл. Пример ниже демонстрирует это:</p>
<pre>
[nancy@asus /var/tmp]$ <strong>ls 2> tmp</strong>

[nancy@asus /var/tmp]$ <strong>ls -l tmp</strong>
-rw-rw-r--  1 nancy nancy 0 Sept  7 12:58 tmp

[nancy@asus /var/tmp]$ <strong>ls 2 > tmp</strong>
ls: 2: No such file or directory
</pre><p>
Первая команда, которую выполняет nancy, правильна (даже несмотря на отсутствие ошибок, и поэтому файл, в который перенаправлялась стандартная ошибка пуст). Вторая команда предполагает, что 2 - это имя файла, которого в данном случае нет, поэтому отображается ошибка.<br />
Все эти особенности подробно описаны в info-страницах Bash.</p>
<h2>Примеры</h2>
<h3>Анализ ошибок</h3>
<p>Если ваш процесс порождает много ошибок, есть способ тщательно их изучить:</p>
<p><span class="mono">command 2>&amp;1 | less</span></p>
<p>Такое часто используется при создании нового программного обеспечения с использованием команды <strong>make</strong>, так как здесь:</p>
<pre>
andy:~/newsoft> <strong>make all 2>&1 | less</strong>
--output ommitted--
</pre><h3>Отделение стандартного вывода от стандартной ошибки</h3>
<p>Конструкции подобные этим часто используется программистами, в результате вывод отображается в одном окне терминала, а ошибки в другом. Сначала выясняется, какой псевдо терминал вы используете выдачей команды <strong>tty</strong>.</p>
<pre>
andy:~/newsoft> make all 2> /dev/pts/7
</pre><h3>Одновременная запись в вывод и в файлы</h3>
<p>Вы можете использовать команду <strong>tee</strong> для копирования ввода на стандартный вывод и один или несколько выходных файлов за один раз. Использование опции <span class="mono">-a</span> c <strong>tee</strong> в результате добавляет ввод в файл(ы). Эта команда полезна, если вы хотите как увидеть, так и сохранить вывод. Операторы > и >> не позволяют выполнить оба действия одновременно.</p>
<p>Этот инструмент обычно называется подачей на конвейер (|), что демонстрируется в следующем примере:</p>
<pre>
mireille ~/test> <strong>date | tee file1 file2</strong>
Thu Jun 10 11:10:34 CEST 2004

mireille ~/test> <strong>cat file1</strong>
Thu Jun 10 11:10:34 CEST 2004

mireille ~/test> <strong>cat file2</strong>
Thu Jun 10 11:10:34 CEST 2004

mireille ~/test> <strong>uptime | tee -a file2</strong>
 11:10:51 up 21 days, 21:21, 57 users,  load average: 0.04, 0.16, 0.26

mireille ~/test> <strong>cat file2</strong>
Thu Jun 10 11:10:34 CEST 2004
 11:10:51 up 21 days, 21:21, 57 users,  load average: 0.04, 0.16, 0.26
</pre>  </div>
    </div></div>
  </body>
</html>
