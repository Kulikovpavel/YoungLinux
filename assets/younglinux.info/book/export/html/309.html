<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Глава 10. Сеть</title>
    <base href="" />
    <link type="text/css" rel="stylesheet" href="http://younglinux.info/misc/print.css" />
      </head>
  <body>
              <div class="section-1">
          
    <div id="node-309" class="section-2">
  <h1 class="book-heading">Глава 10. Сеть</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<h4>Аннотация</h4>
<p>Когда речь идет о сети, то часто выбор падает на операционные системы на базе Linux. Это связано не только с тем, что сеть тесно интегрирована в самой ОС и существует большой набор бесплатных инструментов и приложений. Также это связано с надежностью системы при высоких нагрузках, что было достигнуто после многих лет ее отладки и тестирования в проекте Open Source.</p>
<p>Книжные полки полны информацией, написанной о Linux и сетях, мы же постараемся в этой главе дать краткий обзор. После ее завершения, вы будете знать больше о</p>
<ul>
<li>Поддерживаемых сетевых протоколах</li>
<li>Конфигурационных файлах сети</li>
<li>Командах настройки и исследования сети</li>
<li>Демонах и клиентских программах, запускающих различные сетевые приложения</li>
<li>Разделении доступа к файлам и печати</li>
<li>Удаленном выполнении команд и приложений</li>
<li>Основах сетевого взаимодействия</li>
<li>Безопасном выполнении удаленных приложений</li>
<li>Брандмауэрах и обнаружении вторжений</li>
</ul>
  <div id="node-310" class="section-3">
  <h1 class="book-heading">Беглый обзор сети</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<h3>Модель OSI</h3>
<p>Протокол - это, проще говоря, набор правил для общения.</p>
<p>Для того, чтобы передать данные по сети, например, электронную почту с вашего компьютера на какой-нибудь компьютер в другом конце мира, должны вместе работать множество различных аппаратных и программных средств.<br />
Все эти элементы железа и различного ПО "говорят на разных языках". Представьте, вашу программу для E-mail: она в состоянии обмениваться информацией с операционной системой компьютера через специальный протокол, но не в состоянии "говорить" с компьютерной техникой. Нам нужны специальные программы в операционной системе, которые выполняли бы эту функцию. В свою очередь, компьютер должен быть в состоянии соединяться с телефонной линией или другой аппаратурой для подключения к Интернет. А за кулисами сетевое оборудование должно быть в состоянии соединяться, чтобы передать вашу почту от одного устройства к другому, вплоть до конечного компьютера.</p>
<p>Все эти разные виды протоколов связи подразделяются на 7 уровней, которые известны как модель Open Systems Interconnection Reference (модель взаимодействия открытых систем), или, сокращенно, модель OSI. Для облегчения понимания, эта модель сводится к четырёхуровневому описанию протоколов, как показано в таблице ниже:</p>
<p><strong>Таблица. Упрощенная модель OSI</strong></p>
<table>
<tr>
<td><strong>Название уровня</strong></td>
<td><strong>Протоколы уровня</strong></td>
</tr>
<tr>
<td>Уровень приложений</td>
<td>HTTP, DNS, SMTP, POP, ...</td>
</tr>
<tr>
<td>Транспортный</td>
<td>TCP, UDP</td>
</tr>
<tr>
<td>Сетевой</td>
<td>IP, IPv6</td>
</tr>
<tr>
<td>Уровень доступа к сети</td>
<td>PPP, PPPoE, Ethernet</td>
</tr>
</table>
<p>Каждый уровень может использовать функциональность только уровня, расположенного ниже; каждый уровень может предоставлять функциональность уровню, расположенному выше. Другими словами: уровни взаимодействуют только со своими соседями. Возьмем пример сообщения электронной почты: вы вводите его через прикладной уровень. В вашем компьютере оно спускается до транспортного и сетевого уровня. Ваш компьютер выкладывает его в сеть через уровень доступа к сети. Это уровень, который будет перемещать сообщение по всему миру. В месте назначения принимающий компьютер примет сообщение через свой сетевой уровень, и далее оно будет предоставлено получателю через транспортный и прикладной уровни.</p>
<p class="note"><img src="../../../img/linuxintro/note.gif" alt="" /><strong>В действительности все гораздо сложнее.</strong><br />
Вам рано или поздно придется столкнуться с некоторыми сетевыми терминами; эти разделы дадут вам ряд отправных точек, когда вам захочется узнать о деталях.</p>
<h3>Некоторые популярные сетевые протоколы</h3>
<p>Linux поддерживает много разных сетевых протоколов. Перечислим только наиболее важные:</p>
<h4>TCP/IP</h4>
<p><em>Transport Control Protocol</em> и <em>Internet Protocol</em> являются наиболее популярными способами соединения в Интернете. Множество приложений, таких как браузер и программа для электронной почты, построены в первую очередь на этом наборе протоколов.</p>
<p>Если уж совсем просто говорить, то IP обеспечивает отправку пакетов информации от одной машины к другой, в то время как TCP гарантирует правильную последовательность пакетов, так что пакеты различных приложений не путаются, и будут доставлены получателю в правильном порядке.</p>
<p>Хорошей отправной точкой для получения дополнительной информации о TCP и IP являются следующие документы:</p>
<ul>
<li><strong>man</strong> <span class="mono">7 ip</span>: описание реализации протокола IPv4 на Linux (версия 4 в настоящее время наиболее широко распространенный вариант протокола IP).</li>
<li><strong>man</strong> <span class="mono">7 tcp</span>: реализация протокола TCP.</li>
<li>RFC793, RFC1122, RFC2001 для TCP, и RFC791, RFC1122 и RFC1112 для IP.</li>
</ul>
<p>Документы содержат описания сетевых стандартов, протоколов, приложений и реализации. Эти документы находятся под управлением Internet Engineering Task Force, международной общественности, заинтересованной в бесперебойной работе Интернет и развитии его архитектуры.</p>
<h4>TCP/IPv6</h4>
<p>Никто не ожидал, что Интернет разрастется так быстро. В IP нашлись некоторые недостатки, связанные с большим количеством компьютеров в сети, наиболее серьезный из которых - наличие уникальных адресов, назначаемых каждому компьютеру в сети. Таким образом, IP версии 6 был способен удовлетворить потребности современного Интернет.</p>
<p>К сожалению, не все приложения и службы пока поддерживают IPv6. В настоящее время миграция осуществляется во многих средах, которые могут получить выгоду от обновления до IPv6. Для некоторых приложений, старый протокол все еще используется, для приложений, которые были переработаны, новая версия уже действует. Так проверка конфигурации сети иногда может быть немного запутанной, так как могут быть приняты всевозможные меры, чтобы скрыть один протокол от другого, чтобы не перепутать два соединения.</p>
<p>Более подробную информацию можно найти в следующих документах:</p>
<ul>
<li><strong>man</strong> <span class="mono">7 ipv6</span>: реализация протокола Linux IPv6.</li>
<li>RFC1883 описании протокола Ipv6.</li>
</ul>
<h4>PPP, SLIP, PLIP, PPPOE</h4>
<p>Ядро Linux имеет встроенную поддержку PPP (Point-to-Point-Protocol), SLIP (Serial Line IP), PLIP (Parallel Line IP) и PPPP Over EThernet. PPP - наиболее популярный способ для индивидуальных пользователей получать доступ к их ISP (Internet Service Provider), хотя в густонаселенных районах часто используется PPPOE, протокол, используемый для ADSL (Asymmetric Digital Subscriber Line) соединений.</p>
<p>Большинство дистрибутивов Linux предоставляют легкий в использовании инструмент для настройки Интернет-соединения. Единственное, что вам понадобится - это имя пользователя и пароль для подключения к вашему провайдеру (ISP), и номер телефона в случае PPP. Эти данные вводятся в окно для настройки, которое, вероятно, также позволит запускать и разрывать соединение с вашим провайдером.</p>
<h4>ISDN</h4>
<p>Ядро Linux имеет встроенные возможности ISDN. Isdn4linux управляет картами ISDN PC и может эмулировать модем с набором команд Hayes ("AT" команды). Возможности от просто использования терминальной программы до полного подключения к Интернет.</p>
<p>Посмотрите системную документацию.</p>
<h4>AppleTalk</h4>
<p>Appletalk - это название межсетевого стека Apple. Он делает возможным сетевую модель peer-to-peer, которая обеспечивает основные функциональные возможности, такие как к разделение файлов и принтеров. Каждая машина может одновременно выступать в качестве клиента и сервера, а необходимые программы и аппаратное обеспечение включены в каждый компьютер Apple.</p>
<p>Linux полностью поддерживает сети AppleTalk. Netatalk является реализация на уровне ядра набора протоколов AppleTalk, первоначально это было только для BSD-подобных систем. Включает поддержку маршрутизации AppleTalk, обслуживание файловых систем UNIX и AFS, использующих AppleShare, а также обслуживание принтеров UNIX и доступ к  принтерам AppleTalk.</p>
<h4>SMB/NMB</h4>
<p>Для совместимости с MS Windows  пакет Samba, включающий поддержку протоколов NMB и SMB, может быть установлен на любой UNIX-подобной системе. Протокол Server Message Block (также называемый Session Message Block, NetBIOS или протокол LanManager) используется на MS Windows 3.11, NT, 95/98, 2K и XP для доступа к дискам и принтерам.<br />
Основными функциями пакета Samba являются: разделение дисков Linux с машинами Windows, доступ к SMB частям из машин Linux, совместное использование принтеров Linux с машин Windows и совместное использование принтеров Windows с машин Linux.</p>
<p>Большинство дистрибутивов Linux поставляются с пакетом samba, который делает большую часть работы при установке сервера и запускает smbd, сервер Samba, и nmbd, netbios имени сервера, загрузочное время по умолчанию. Samba можно настроить графически, с помощью веб-интерфейса или через командную строку, а также текстовые конфигурационные файлы. Демоны заставляют машину Linux представляться как хост Windows в сетевом окружении Windows; разделяемые ресурсы компьютера с Linux будут неотличимы от любого другого компьютера в среде MS Windows.</p>
<p>Более подробную информацию можно найти в следующих местах:</p>
<ul>
<li><strong>man</strong> <span class="mono">smb.conf</span>: описывает формат основного конфигурационного файла Samba.</li>
<li>Samba Project Documentation (или проверьте локальные зеркала samba.org) содержит подробное руководство об установке и тестировании, в котором также объясняется, как настроить сервер Samba в качестве основного контроллера домена. Все man-страницы также доступны здесь.</li>
</ul>
<h4>Смешанные протоколы</h4>
<p>Linux также имеет поддержку для Amateur Radio, сетей WAN (X25, Frame Relay, ATM), InfraRed и других беспроводных соединений, но, поскольку эти протоколы обычно требуют специального оборудования, мы не будем обсуждать их в данном документе.</p>
  </div>
<div id="node-311" class="section-3">
  <h1 class="book-heading">Конфигурация сети и информация о ней</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<h3>Конфигурация сетевых интерфейсов</h3>
<p>Все большие дружелюбные дистрибутивы Linux поставляются с различными графическими инструментами, которые позволяют легко подключить компьютер к локальной сети, поставщику услуг Интернета или настроить беспроводное соединение. Эти инструменты могут быть запущены из командной строки или из меню:</p>
<ul>
<li>Настроить Ubuntu можно так: <strong>Система ? Администрирование ? Сеть</strong>.</li>
<li>RedHat Linux поставляется с <strong>redhat-config-network</strong>, который имеет как графический интерфейс, так и работает в текстовом режиме.</li>
<li>YAST Suse или YaST2 представляет собой инструмент настройки "все-в-одном".</li>
<li>Mandrake/Mandriva поставляется с мастером настройки сети и Интернет, который обычно запускается из <strong>Центра управления Mandriva</strong>.</li>
<li>В системах Gnome - <strong>gnome-network-preferences</strong>.</li>
<li>В системах KDE - <strong>knetworkconf</strong>.</li>
</ul>
<p>Системная документация содержит множество советов и информации о наличии и использовании этих программ.</p>
<p>Информация, которую вам необходимо предоставить:</p>
<ul>
<li>Для подключения к локальной сети, например, с домашних компьютеров или на работе: имена хоста, домена и IP-адрес. Если вы хотите установить собственную сеть, лучше всего сначала почитать что-нибудь еще. На работе эту информацию компьютер может получать автоматически при загрузке. Если вы сомневаетесь, то лучше ничего не указывать, чем прописывать неизвестно что.</li>
<li>Для подключения к Интернет: имя пользователя и пароль для вашего провайдера, номер телефона при использовании модема. Ваш провайдер обычно автоматически назначает вам IP-адрес и все остальное, что необходимо для работы ваших интернет-приложений.</li>
</ul>
<h3>Сетевые конфигурационные файлы</h3>
<p>Графические программы-помощники редактируют определенный набор конфигурационных файлов сети, используя несколько основных команд. Точные имена конфигурационных файлов и их расположение в файловой системе в значительной степени зависит от вашего дистрибутива и его версии. Тем не менее, несколько сетевых конфигурационных файлов можно найти на всех UNIX-системах:</p>
<h4>/etc/hosts</h4>
<p>Файл <span class="mono">/etc/hosts</span> всегда содержит локальный IP-адрес 127.0.0.1, который используется для связи между процессами. Никогда не удаляйте эту строку! Иногда содержит адреса дополнительных хостов, с которыми можно соединиться без использования внешней службы имен, такой как DNS (Domain Name Server).</p>
<p>Пример файла хостов для небольшой домашней сети:</p>
<pre>
# Do not remove the following line, or various programs
# that require network functionality will fail.
127.0.0.1       localhost.localdomain   localhost
192.168.52.10	tux.mylan.com		tux
192.168.52.11	winxp.mylan.com		winxp
</pre><p>Дополнительная информация содержится в <strong>man</strong> <span class="mono">hosts</span>.</p>
<h4>/etc/resolv.conf</h4>
<p>В файле <span class="mono">/etc/resolv.conf</span> настраивается доступ к DNS-серверу. Этот файл содержит ваши доменные имена и имена сервера(ов) для соединения:</p>
<pre>
search mylan.com
nameserver 193.134.20.4
</pre><p>Дополнительную информацию можно почерпнуть на man-страницах  <span class="mono">resolv.conf</span>.</p>
<h4>/etc/nsswitch.conf</h4>
<p>Файл <span class="mono">/etc/nsswitch.conf</span> определяет порядок, в котором происходит связь с различными службами имен. Для использования Интернет, важно, чтобы dns появилась в строке "hosts":</p>
<pre>
[bob@tux ~] <strong>grep hosts /etc/nsswitch.conf</strong>
hosts:	files dns
</pre><p>Это указывает компьютеру на поиск имен хостов и IP-адресов сначала в файле <span class="mono">/etc/hosts</span>, и связь с сервером DNS, если данный хоста нет в локальном файле <span class="mono">hosts</span>. Другими возможными именами сервисов для соединения являются LDAP, NIS и NIS +.</p>
<p>Подробнее в <strong>man</strong> <span class="mono">nsswitch.conf</span>.</p>
<h3>Сетевые конфигурационные команды</h3>
<h4>Команда ip</h4>
<p>Специфичные для дистрибутива скрипты и графические инструменты — это надстройки к <strong>ip</strong> (или <strong>ifconfig</strong> и <strong>route</strong> на старых системах) для просмотра и настройки сетевой конфигурации ядра.</p>
<p>Команда <strong>ip</strong> используется для присвоения IP-адресов интерфейсам, установки маршрутов к Интернет и другим сетям, отображения конфигураций TCP/IP и так далее.</p>
<p>Следующие команды показывают IP-адрес и информацию о маршрутизации:</p>
<pre>
benny@home benny> <strong>ip addr show</strong>
1: lo: <LOOPBACK,UP> mtu 16436 qdisc noqueue 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 brd 127.255.255.255 scope host lo
    inet6 ::1/128 scope host 
2: eth0: <BROADCAST,MULTICAST,UP> mtu 1500 qdisc pfifo_fast qlen 100
    link/ether 00:50:bf:7e:54:9a brd ff:ff:ff:ff:ff:ff
    inet 192.168.42.15/24 brd 192.168.42.255 scope global eth0
    inet6 fe80::250:bfff:fe7e:549a/10 scope link 

benny@home benny> <strong>ip route show</strong>
192.168.42.0/24 dev eth0  scope link 
127.0.0.0/8 dev lo  scope link 
default via 192.168.42.1 dev eth0 
</broadcast,multicast,up></loopback,up></pre><p>На что стоит обратить внимание:</p>
<ul>
<li>Два сетевых интерфейса даже на системе, которая имеет только одну карту с сетевым интерфейсом: "lo" является локальным узлом, используемым для внутренней сетевой коммуникации; "eth0" является общим названием для реального интерфейса. Никогда не изменяйте конфигурацию локального узла, иначе ваша машина перестанет нормально работать! Беспроводные интерфейсы, как правило, определяется как "wlan0"; модемные интерфейсы как "ppp0", хотя могут быть и другие имена.</li>
<li>IP-адреса, отмеченные как "inet": у локального узла всегда 127.0.0.1, физический интерфейс может иметь любую другую комбинацию.</li>
<li>Аппаратный адрес вашего интерфейса, который может потребоваться как часть процедуры проверки подлинности для подключения к сети, отмечен как "ether". У локального узла имеется 6 пар из нулей, физический узел состоит из 6 пар шестнадцатеричных символов, из которых первые 3 пары зависят от конкретного производителя.</li>
</ul>
<h4>Команда ifconfig</h4>
<p>Хотя <strong>ip</strong> является самым новым способом настроить систему Linux, по-прежнему популярным является <strong>ifconfig</strong>. Используйте его без опции для вывода информации о сетевом интерфейсе:</p>
<pre>
els@asus:~$ <strong>/sbin/ifconfig</strong>
eth0      Link encap:Ethernet  HWaddr 00:50:70:31:2C:14
          inet addr:60.138.67.31  Bcast:66.255.255.255  Mask:255.255.255.192
          inet6 addr: fe80::250:70ff:fe31:2c14/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:31977764 errors:0 dropped:0 overruns:0 frame:0
          TX packets:51896866 errors:0 dropped:0 overruns:0 carrier:0
          collisions:802207 txqueuelen:1000
          RX bytes:2806974916 (2.6 GiB)  TX bytes:2874632613 (2.6 GiB)
          Interrupt:11 Base address:0xec00
										lo        Link encap:Local Loopback
	  inet addr:127.0.0.1  Mask:255.0.0.0
	  inet6 addr: ::1/128 Scope:Host
	  UP LOOPBACK RUNNING  MTU:16436  Metric:1
	  RX packets:765762 errors:0 dropped:0 overruns:0 frame:0
	  TX packets:765762 errors:0 dropped:0 overruns:0 carrier:0
	  collisions:0 txqueuelen:0
	  RX bytes:624214573 (595.2 MiB)  TX bytes:624214573 (595.2 MiB)
</pre><p>Также отметим наиболее важные аспекты конфигурации интерфейса:</p>
<ul>
<li>IP-адрес отмечен как "inet addr".</li>
<li>Аппаратный адрес тегом "HWaddr".</li>
</ul>
<p>Обе команды (<strong>ifconfig</strong> и <strong>ip</strong>) отображают более подробные сведения о конфигурации и ряд статистических данных о каждом интерфейсе и, наверное, самое главное, является ли он "UP" и "RUNNING".</p>
<h4>Команды PCMCIA</h4>
<p>На вашем ноутбуке, который вы обычно подключаете к корпоративной сети с помощью Ethernet-соединения, но которое вы сейчас настраиваете для dial-in дома или в отеле, возможно необходимо активировать карту PCMCIA. Это делается с помощью утилита управления <strong>cardctl</strong>, или <strong>pccardctl</strong> на новых дистрибутивах.</p>
<p>Пример использования:</p>
<p><span class="mono">cardctl insert</span></p>
<p>Теперь карта может быть настроена с помощью графического или интерфейса командной строки. До извлечения карты используйте следующую команду:</p>
<p><span class="mono">cardctl eject </span></p>
<p>Тем не менее, хороший дистрибутив должн обеспечить поддержку PCMCIA в инструментах конфигурации сети, предотвращая пользователей от необходимости выполнять команды PCMCIA вручную.</p>
<h4>Дополнительная информация</h4>
<p>Дальнейшее обсуждение настройки сети выходит за рамки этого документа. Вашим основным источником дополнительной информации будут man-страницы для служб, которые вы хотите установить. Дополнительное чтение:</p>
<ul>
<li>Модем-HOWTO (tldp.org/HOWTO/Modem-HOWTO.html). Поможет с выбором, соединением, настройкой, поиском неисправностей и пониманием аналоговых модемов для ПК.</li>
<li>LDP HOWTO Index, раздел 4.4 (tldp.org/HOWTO/HOWTO-INDEX/networking.html). Список HOWTO по категориям об обычных сетях, протоколах, dial-up, DNS, VPNs, мостах, маршрутизации, безопасности и многом другом.</li>
<li>На большинстве систем есть версия файла <span class="mono">ip-cref</span> (найти его можно с помощью команды <strong>locate</strong>); формат PS этого файла можно просматривается, например, с помощью <strong>gv</strong>.</li>
</ul>
<h3>Названия сетевых интерфейсов</h3>
<p>На Linux-машине, название устройства <em>lo</em> или локальный узел связано с внутренним адресом 127.0.0.1. Компьютер будет иметь сложности, заставляя ваши приложения работать, если это устройство не будет существовать; так всегда даже на тех компьютерах, которые не объединены в сеть.</p>
<p>Первое ethernet-устройство, <em>eth0</em>, в случае стандартной сетевой картой, указывает на ваш локальный адрес IP-сети. Обычные клиентские машины имеют только одну сетевую карту. Маршрутизаторы (роуторы), связующие сети между собой, имеют по одному сетевому устройству на каждую сеть, которую они обслуживают.</p>
<p>Если вы используете модем для подключения к Интернет, ваше сетевое устройство, скорее всего, будет называться <em>ppp0</em>.</p>
<p>Существует намного больше имен, например, для интерфейса Virtual Private Network (VPN), и множество интерфейсов могут быть активны одновременно, так что вывод команд <strong>ifconfig</strong> или <strong>ip</strong> может быть довольно длинным, если не использовать опции. Даже могут быть активны несколько интерфейсов одного и того же типа. В этом случае, они нумеруются последовательно: первый получит номер 0, второй получит суффикс 1, третий 2, и так далее. Так обстоит дело на многих серверных приложениях, на машинах с отказоустойчивой конфигурацией, роутерах, брандмауэрах и многом другом.</p>
<h3>Проверка конфигурации хоста с помощью netstat</h3>
<p>Кроме команды <strong>ip</strong> для отображения конфигурации сети, есть команд <strong>netstat</strong>, которая имеет много опций и, как правило, полезна в любой системе UNIX.</p>
<p>Маршрутизация информация может быть отображена с помощью опции <span class="mono">-nr</span> команды <strong>netstat</strong>:</p>
<pre>
bob:~> <strong>netstat -nr</strong>
Kernel IP routing table
Destination  Gateway      Genmask       Flags MSS Window irtt Iface
192.168.42.0 0.0.0.0      255.255.255.0 U      40 0         0 eth0
127.0.0.0    0.0.0.0      255.0.0.0     U      40 0         0 lo
0.0.0.0      192.168.42.1 0.0.0.0       UG     40 0         0 eth0
</pre><p>Это обычный клиентский компьютер в сети IP. У него только одно сетевое устройство, <em>eth0</em>. Интерфейс <em>lo</em> является локальным узлом.</p>
<p class="note"><img src="../../../img/linuxintro/note.gif" alt="" /><strong>Современный способ</strong><br />
Новый способ получить эту же информацию от вашей системы – использовать команду <strong>ip</strong>:<br />
<span class="mono">ip route show</span></p>
<p>Когда эта машина пытается соединиться с хостом, находящимся в другой сети, а не  ее собственной, обозначаемый линией, начиная с 0.0.0.0, она будет посылать запросы на подключение к маршрутизатору с IP-адресом 192.168.42.1, и будет использовать основной интерфейс, <em>eth0</em>, чтобы сделать это.</p>
<p>Хосты, которые находятся в той же сети, имеют линию, начиная с 192.168.42.0, также будут соединяться через основной сетевой интерфейс, но нет необходимости в маршрутизаторе, данные просто выкладываются в сеть.</p>
<p>Компьютеры могут иметь гораздо более сложные таблицы маршрутизации, с большим количеством различных пар "адресат-шлюз" для подключения к различным сетям. Если у вас есть возможность подключиться к серверу приложений, например, на работе, то ради интереса проверьте информацию о маршрутизации.</p>
<h3>Другие хосты</h3>
<p>Внушительное количество инструментов ориентировано на управление сетью и удаленное администрирование машин Linux. Ваше местное зеркало программного обеспечения для Linux предложит множество из них. Это увело бы нас слишком далеко, если обсуждать их в этом документе, поэтому, пожалуйста, обратитесь к  документации конкретных программ.</p>
<p>В этом разделе мы обсудим только некоторые общие UNIX/Linux текстовые инструменты.</p>
<h4>Команда host</h4>
<p>Для отображения информации о хостах или доменах используется команда <strong>host</strong>:</p>
<pre>
[emmy@pc10 emmy]$ <strong>host www.eunet.be</strong>
www.eunet.be. has address 193.74.208.177

[emmy@pc10 emmy]$ <strong>host -t any eunet.be</strong>
eunet.be. SOA dns.eunet.be. hostmaster.Belgium.EU.net. 
  2002021300 28800 7200 604800 86400
eunet.be. mail is handled by 50 pophost.eunet.be.
eunet.be. name server ns.EU.net.
eunet.be. name server dns.eunet.be.
</pre><p>Аналогичная информация может быть отображена с помощью команды <strong>dig</strong>, которая предоставляет дополнительную информацию о том, каким образом записи хранятся на сервере имен.</p>
<h4>Команда ping</h4>
<p>Чтобы проверить, доступен ли хост, используйте <strong>ping</strong>. Если ваша система настроена отправлять более одного пакета, <strong>ping</strong> можно прервать комбинацией клавиш <strong>Ctrl + C</strong>:</p>
<pre>
[emmy@pc10 emmy]$ <strong>ping a.host.be</strong> 
PING a.host.be (1.2.8.3) from 80.20.84.26: 56(84) bytes of data.
64 bytes from a.host.be(1.2.8.3):icmp_seq=0 ttl=244 time=99.977msec
--- a.host.be ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max/mdev = 99.977/99.977/99.977/0.000 ms
</pre><h4>Команда traceroute</h4>
<p>Чтобы проверить маршрут, по которому пакеты следуют к сетевому узлу, используйте команду <strong>traceroute</strong>:</p>
<pre>
[emmy@pc10 emmy]$ <strong>/usr/sbin/traceroute www.eunet.be</strong>
traceroute to www.eunet.be(193.74.208.177),30 hops max,38b packets
1 blob (10.0.0.1)  
       0.297ms  0.257ms  0.174ms
2 adsl-65.myprovider.be (217.136.111.1) 
       12.120ms 13.058ms 13.009ms
3 194.78.255.177 (194.78.255.177)  
       13.845ms 14.308ms 12.756ms
4 gigabitethernet2-2.intl2.gam.brussels.skynet.be (195.238.2.226)
       13.123ms 13.164ms 12.527ms
5 pecbru2.car.belbone.be (194.78.255.118) 
       16.336ms 13.889ms 13.028ms
6 ser-2-1-110-ias-be-vil-ar01.kpnbelgium.be (194.119.224.9)
       14.602ms 15.546ms 15.959ms
7 unknown-195-207-939.eunet.be (195.207.93.49) 
       16.514ms 17.661ms 18.889ms
8 S0-1-0.Leuven.Belgium.EU.net (195.207.129.1) 
       22.714ms 19.193ms 18.432ms
9 dukat.Belgium.EU.net (193.74.208.178) 22.758ms * 25.263ms
</pre><p>На некоторых системах  <strong>traceroute</strong> может быть переименована в <strong>tracepath</strong>.</p>
<h4>Команда whois</h4>
<p>Специфичная информация о доменных именах может быть получена с помощью команды <strong>whois</strong>, которая разъясняется множеством <strong>whois</strong> серверов, как показано ниже:</p>
<pre>
[emmy@pc10 emmy]$ <strong>whois cnn.com</strong>
[whois.crsnic.net]

Whois Server Version 1.3

	$&lt;--snap server message-->

   Domain Name: CNN.COM
   Registrar: NETWORK SOLUTIONS, INC.
   Whois Server: whois.networksolutions.com
   Referral URL: networksolutions.com
   Name Server: TWDNS-01.NS.AOL.COM
   Name Server: TWDNS-02.NS.AOL.COM
   Name Server: TWDNS-03.NS.AOL.COM
   Name Server: TWDNS-04.NS.AOL.COM
   Updated Date: 12-mar-2002
>>> Last update of whois database: Fri, 5 Apr 2002 05:04:55 EST &lt;&lt;&lt;

The Registry database contains ONLY .COM, .NET, .ORG, .EDU domains
and Registrars.

[whois.networksolutions.com]

        $&lt;--snap server message-->

Registrant:
Turner Broadcasting (CNN-DOM)
   1 CNN Center
   Atlanta, GA 30303

   Domain Name: CNN.COM

   Administrative Contact:
        $&lt;--snap contactinfo-->   
   Technical Contact:
        $&lt;--snap contactinfo-->   
   Billing Contact:
	$&lt;--snap contactinfo-->
   Record last updated on 12-Mar-2002.
   Record expires on 23-Sep-2009.
   Record created on 22-Sep-1993.
   Database last updated on 4-Apr-2002 20:10:00 EST.

   Domain servers in listed order:

   TWDNS-01.NS.AOL.COM		149.174.213.151
   TWDNS-02.NS.AOL.COM		152.163.239.216
   TWDNS-03.NS.AOL.COM		205.188.146.88
   TWDNS-04.NS.AOL.COM		64.12.147.120
</pre><p>Для других доменных имен, отличных от .com, .net, .org и .edu, возможно, потребуется указать сервер whois, например, как для этого домена .be:<br />
<span class="mono">whois domain.be@whois.dns.be</span></p>
  </div>
<div id="node-312" class="section-3">
  <h1 class="book-heading">Internet/Intranet приложения</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<p>Система Linux является отличной платформой для предоставления сетевых сервисов. В этом разделе мы попытаемся дать краткий обзор наиболее распространенных сетевых серверов и приложений.</p>
<h3>Типы серверов</h3>
<h4>Автономный сервер</h4>
<p>Предоставляемые пользователям сервисы могут быть доступны двумя разными способами. Демон или служба могут работать или в автономном режиме, или зависеть от активации другого сервиса.</p>
<p>Сервисы сети, которые сильно и/или постоянно используются, как правило, работают в автономном режиме: они представляют собой независимые программы-демоны, которые работают всегда. Они чаще всего запускаются во время загрузки системы и ожидают запросы по специальным точкам соединениям или портам, которые они прослушивают. Когда приходит запрос, он обрабатывается, и прослушивание продолжается до следующего запроса. Веб-сервер представляет собой типичный пример: вы хотите, чтобы он был доступен 24 часа в сутки, поэтому при большой загрузке следует создать больше прослушивающих служб, обслуживающих одновременно работающих пользователей. Другими примерами являются большие архивы программного обеспечения или зеркала, которое должно обрабатывать тысячи FTP-запросов в день.</p>
<p>Примером автономного сетевого сервиса на домашнем компьютере может быть <strong>named</strong> (демон named), кэширующий сервер имен. У автономных сервисов есть  собственные запущенные процессы, вы можете проверить это в любое время с помощью <strong>ps</strong>:</p>
<pre>
bob:~> <strong>ps auxw | grep named</strong>
named   908  0.0  1.0 14876 5108 ?   S  Mar14  0:07 named -u named
</pre><p>
При этом существуют некоторые службы, которые вы можете использовать на вашем ПК, даже если не будет существовать запущенного для него серверного процесса. В качестве примера можно привести службы FTP, сервис безопасного копирования. У таких служб есть интернет-демон (<strong>inetd</strong>) прослушивающий их на месте.</p>
<h4>(x)inetd</h4>
<p>На вашем домашнем компьютере обычно немного спокойнее. У вас может быть небольшая сеть, и вы передаете файлы с одного ПК на другой время от времени, используя FTP или Samba (для связи с машинами MS Windows). В таких случаях все службы, которые вам нужны, запускаются время от времени, работать с ними все время было бы пустой тратой ресурсов. Поэтому в небольших установках вы обнаружите, что необходимые демоны зависит от центральной программы, которая прослушивает все порты служб, за которые она несет ответственность.</p>
<p>Этот супер-сервер, демон сетевых сервисов, запускается во время системной инициализации. Существует две распространенные реализации: <strong>inetd</strong> и <strong>xinetd</strong> (расширенный демон интернет-услуг). Тот или иной обычно запущен на каждой системе Linux:</p>
<pre>
bob:~> <strong>ps -ef | grep inet</strong>
root  926   1 0 Mar14 ?   00:00:00 xinetd-ipv6 -stayalive -reuse \
-pidfile /var/run/xinetd.pid
</pre><p>Службы, за которые отвечает интернет-демон, перечислены в его конфигурационном файле <span class="mono">/etc/inetd.conf</span> для <strong>inetd</strong> и в каталоге <span class="mono">/etc/xinetd.d</span> для <strong>xinetd</strong>. Обычно управляемые службы включают сервисы разделения файлов и печати, SSH, FTP, telnet, конфигурационный демон Samba, опрашивающие и временные службы.</p>
<p>Как только запрос на соединение получен, центральный сервер запускает необходимую службу. Так в приведенном ниже примере, когда пользователь bob запускает FTP-сессию к локальному хосту, FTP-демон работает, пока сессия активна:</p>
<pre>
bob:~> <strong>ps auxw | grep ftp</strong>
bob     793  0.1  0.2  3960 1076 pts/6    S    16:44   0:00 ncftp localhost
ftp     794  0.7  0.5  5588 2608 ?        SN   16:44   0:00 ftpd: 
localhost.localdomain: anonymous/bob@his.server.com: IDLE
</pre><p>Конечно, то же самое происходит при открытии соединения с удаленными хостами: либо демон отвечает непосредственно, либо удаленный <strong>(x)inetd</strong> запускает нужную вам службу, и останавливает ее, когда вы выходите.</p>
<h3>Почта</h3>
<h4>Серверы</h4>
<p>Sendmail является стандартной почтовой серверной программой или агентом почтовой пересылки для платформ UNIX. Она надежна, масштабируема и при правильной настройке соответствующего оборудования без проблем поддерживает тысячу пользователей. Более подробную информацию о настройке Sendmail входит в пакеты sendmail и sendmail-cf, вы можете прочитать файлы <span class="mono">README</span> и <span class="mono">README.cf</span> в <span class="mono">/usr/share/doc/sendmail</span>. Также полезны будут <strong>man <span class="mono">sendmail</span></strong> и <strong>man <span class="mono">aliases</span></strong>.</p>
<p>Qmail другой почтовый сервер, который приобретает все большую популярность, поскольку утверждается, что он более безопасен, чем Sendmail. Хотя Sendmail является монолитной программой, Qmail состоит из меньшего числа взаимодействующих частей программы, что может обеспечивать лучшую безопасность. Postfix и Exim являются примерами других почтовых серверов, которые набирают популярность.</p>
<p>Эти серверы обрабатывают списки рассылки, выполняют фильтрацию, сканируют  на вирусы и делают многое другое. Бесплатные и коммерческие сканеры доступны для использования в Linux. Примеры программного обеспечения для рассылки - Mailman, Listserv, Majordomo и EZmlm. Посмотрите веб-страницу предпочитаемого вами антивирусного сканера для получения информации о  клиентской и серверной поддержкеа на Linux. Amavis и Spamassassin свободные реализации сканеров на вирусы и спам.</p>
<h4>Удаленные почтовые серверы</h4>
<p>Наиболее популярных протоколы для доступа к почте удаленно POP3 и IMAP4. Оба, IMAP и POP, позволяет офлайновую работу, удаленный доступ к новым письмам, и оба зависят от сервера SMTP для отправки почты.</p>
<p>Хотя POP представляет собой простой протокол, легкий в реализации и поддерживает практически любой почтовый клиент, IMAP является предпочтительным, потому что:</p>
<ul>
<li>Он может управлять метками статуса сообщений.</li>
<li>Он может как хранить, так и получать сообщения.</li>
<li>Он может получать доступ и управлять несколькими почтовыми ящиками.</li>
<li>Он поддерживает одновременное обновление и общие почтовые ящики.</li>
<li>Он также подходит для доступа к сообщениям Usenet и другим документам.</li>
<li>IMAP работает как в он-лайн так и офф-лайн.</li>
<li>Он оптимизирован для работы в он-лайн, особенно по низкоскоростным ссылкам.</li>
</ul>
<h4>Mail-агенты пользователя</h4>
<p>Есть много текстовых и графических почтовых клиентов, мы назовем несколько из наиболее распространенных. Выберите наилучший для вас.</p>
<p>Команда UNIX <strong>mail</strong> использовалась в течение многих лет еще до того, как появились сети. Она представляет собой простой интерфейс для отправки сообщений и небольших файлов другим пользователям, которые затем могут сохранить сообщение, перенаправить или ответить на него.</p>
<p>Хотя эта программа уже почти не используется в качестве клиента, она все еще может быть полезна, например, если на почту кому-то отправить вывод команды:</p>
<p><span class="mono">mail <future.employer@whereIwant2work.com> &lt; cv.txt </future.employer@whereiwant2work.com></span></p>
<p>Читатель почты <strong>elm</strong> — очень важное улучшение для <strong>mail</strong>, и также есть <strong>pine</strong> (Pine Is Not ELM). Более новый читатель почты mutt предлагает такие возможности как многопоточность.</p>
<p>Для тех пользователей, которые предпочитают графический интерфейс, существуют сотни вариантов. Наиболее популярны для новых пользователей Mozilla Mail/Thunderbird, который легко настраивается против спама, а Evolution представляет собой клон MS Outlook. Kmail пользуется популярностью среди пользователей KDE.</p>
<p><strong>Рисунок 10.1. Почтовая программа Evolution</strong><br />
<img src="../../../img/linuxintro/evolution.png" width="716" height="519" alt="Программа для чтения почты в Linux" /></p>
<p>Существуют также десятки web-mail приложений, таких как Squirrelmail, Yahoo! mail, gmail от Google and Hotmail.</p>
<p>Большинство дистрибутивов Linux включают <strong>fetchmail</strong>, утилиту для восстановления и отправки почты. Она забирает почту с удаленных почтовых серверов (POP, IMAP и некоторые другие) и направляет ее к вашей локальной системе доставки. После этого можно обрабатывать полученную почту с помощью обычных почтовых клиентов. Эта программа может быть запущена в режиме демона для многократного опроса одного или нескольких систем в указанный промежуток времени. Информация и примеры использования можно найти в info-страницах; каталог <span class="mono">/usr/share/doc/fetchmail[-<version>]</version></span> содержит полный список возможностей и FAQ для новичков.</p>
<p>Фильтр <strong>procmail</strong> может быть использован для фильтрации входящей почты, создания списков рассылки, предварительной обработки почты, выборочно пересылать электронную почту и многое другое. Сопутствующая ему программа <strong>formail</strong> среди прочего позволяет генерировать автоответы и разделение почтовых ящиков. Procmail работал в течение многих лет на машинах UNIX и Linux и является надежной системой, предназначенной для работы даже в наихудших обстоятельствах. Более подробную информацию можно найти в каталоге <span class="mono">/usr/share/doc/procmail[-<version>]</version></span> и на справочных страницах.</p>
<p class="note"><img src="../../../img/linuxintro/note.gif" alt="" /><strong>Заметка о почтовом этикете</strong><br />
Некоторые люди в наши дни, возможно, думают, что сообщение электронной почты не должна быть слишком формальными. Конечно, все зависит от обстоятельств. Если вы пишете тому, кого вы не знаете, лучше держать на некотором расстоянии, как вы бы делали в традиционном письме. И не забывайте: человек, которого вы не знаете, может оказаться как мужчиной, так и женщиной ...</p>
<h3>Web</h3>
<h4>Веб-сервер Apache</h4>
<p>Apache на сегодняшний день является самым популярным веб-сервером, используемом на более чем половине всех серверов в сети Интернет. Большинство Linux дистрибутивов включают Apache. Преимущества Apache заключаются в модульной разработке, поддержке SSL, стабильности и скорости. При наличии соответствующих аппаратных средств и их настройке он может выдерживать высокие нагрузки.</p>
<p>В системах Linux конфигурация сервера, как правило, делается в каталоге <span class="mono">/etc/httpd</span>. Наиболее важным конфигурационным файлом является <span class="mono">httpd.conf</span>; он пожалуй достаточно очевидный. Если вам нужна помощь, вы можете найти ее на man-странице <strong>httpd</strong> или на веб-сайт Apache.</p>
<h4>Веб-броузеры</h4>
<p>Для платформы Linux существует большое количество как бесплатных, так и коммерческих веб-браузеров. Netscape Navigator как единственный достойный вариант уже давно ушел в прошлое, так Mozilla/Firefox предлагает конкурентоспособную альтернативу, работающую также хорошо на многих других операционных системах, таких как MS Windows и MacOS X.</p>
<p>Amaya является W3C браузером. Opera - коммерческих браузер, компактный и быстрый. Многие менеджеры рабочего стола включают возможность просмотра веб-страниц в их файловом менеджере.</p>
<p>Популярными текстовыми браузерами являются <strong>lynx</strong> и <strong>links</strong>. Возможно, вам придется определить прокси-серверов в вашей оболочке, установив соответствующие переменные. Текстовые браузеры быстры и удобны, когда не установлена графическая среда, также как и при использовании в скриптах.</p>
<h4>Proxy-серверы</h4>
<h5>Что такое proxy-сервер?</h5>
<p>Компании и организации часто хотят, чтобы их пользователи могли использовать прокси-сервер. Особенно в среде с большим количеством пользователей прокси-сервер может позволить быструю загрузку веб-страниц. Прокси-сервер сохраняет веб-страницы. Когда пользователь запрашивает веб-страницу, которая уже была запрошена ранее, прокси-сервер выдаст пользователю ту страницы напрямую, без обращения к сети Интернет, что занимает меньше времени. Конечно, такой ход событий может быть приемлем, когда прокси-сервер делает быструю проверку и всегда предоставляет самую последнюю версию страницы. В некоторых средах использование прокси-сервера является обязательным, в других средах может быть выбор, следует ли его использовать.</p>
<h5>Конфигурация прокси</h5>
<p>Если у вас есть имя и порт прокси-сервера, это должно быть достаточно очевидным, чтобы скормить эту информацию в вашем браузере. Однако многие (командная строка) приложения зависят от переменных <span class="mono">http_proxy</span> и <span class="mono">ftp_proxy</span> для правильного функционирования. Для вашего удобства вы можете добавить строку подобной следующей в файл <span class="mono">~/.bashrc</span>:</p>
<p><span class="mono">export http_proxy=http://username:password@proxy_server_name:port_number</span></p>
<p>Например:</p>
<p><span class="mono">export http_proxy=http://willy:Appelsi3ntj3@proxy:80</span></p>
<p>Если вам не требуется задавать имя пользователя и пароль, просто не вписывайте их до знака "@", а сам знак следует оставить.</p>
<h3>File Transfer Protocol</h3>
<h4>FTP-серверы</h4>
<p>На системах Linux сервер FTP, как правило, запускается от <strong>xinetd</strong>, используя  сервер WU-ftpd, хотя FTP-сервер может быть настроен как автономный на системах с огромным FTP-трафиком. Смотрите упражнения.</p>
<p>Другие серверы FTP включают среди прочих vsftpd, Ncftpd и Proftpd.</p>
<p>Большинство дистрибутивов содержат пакет anonftp, который устанавливает анонимное дерево FTP-сервера и сопутствующие файлы конфигурации.</p>
<h4>FTP-клиенты</h4>
<p>Большинство дистрибутивов Linux включают <strong>ncftp</strong>, улучшенную версию распространенной команды UNIX <strong>ftp</strong>, которая может быть вам также знакома по командной строки Windows. Программа <strong>ncftp</strong> предлагает дополнительные функции, такие как лучший и понятный интерфейс пользователя, завершение имени файла, добавление и возобновление функций, закладки, управление сессиями и т.д.:</p>
<pre>
thomas:~> <strong>ncftp blob</strong>
NcFTP 3.0.3 (April 15, 2001) by Mike Gleason (ncftp@ncftp.com).
Connecting to blob...
blob.some.net FTP server (Version wu-2.6.1-20) ready.
Logging in...
Guest login ok, access restrictions apply.
Logged in to blob.
ncftp / > <strong>help</strong>
Commands may be abbreviated.  'help showall' shows hidden and 
unsupported commands.  
'help <command>' gives a brief description of <command>.

ascii      cat      help      lpage     open     quote    site     
bgget      cd       jobs      lpwd      page     rename   type     
bgput      chmod    lcd       lrename   pdir     rhelp    umask    
bgstart    close    lchmod    lrm       pls      rm       version  
binary     debug    lls       lrmdir    put      rmdir      
bookmark   dir      lmkdir    ls        pwd      set        
bookmarks  get      lookup    mkdir     quit     show       
ncftp / > 
</command></command></pre><p>Отличную помощь с большим количеством примеров можно найти в документации. И опять же, существует ряд приложений с GUI.</p>
<p class="note"><img src="../../../img/linuxintro/warning.gif" alt="" /><strong>FTP не безопасен!</strong><br />
Не используйте протокол передачи файлов для неанонимного логина, если вы не уверены в том, что вы делаете. Ваше имя пользователя и пароль могут быть захвачены злонамеренными пользователями сети! Вместо этого используйте защищенное FTP; программа sftp поставляется с пакетом Secure SHell, см. Раздел "Безопасное удаленное копирование".</p>
<h3>Чаты и конференции</h3>
<p>В каждом дистрибутиве доступны различные клиенты и системы, которые заменяют старый IRC-стиль текстовых чатов. Вот короткий и неполный перечень наиболее популярных программ:</p>
<ul>
<li><strong>pidgin</strong>: мульти-протокольный клиент обмена мгновенными сообщениями под Linux, Windows и Mac, совместимый с MSN Messenger, ICQ, IRC и многими другими; смотрите info-страницы или сайт этой программы.</li>
<li><strong>xchat</strong>: IRC клиент для X Window System:</li>
</ul>
<p><strong>Рисунок 10.2. X-Chat</strong><br />
<img src="../../../img/linuxintro/xchat.png" width="650" height="427" alt="Программа xchat" /></p>
<ul>
<li><strong>aMSN</strong>: клон MSN.</li>
<li><strong>Konversation, kopete, KVIrc</strong> и многие другие К-инструменты из пакета KDE.</li>
<li><strong>gnomemeeting</strong>: программы видеоконференции для UNIX (в настоящее время Ekiga).</li>
<li><strong>jabber</strong>: программа для обмена мгновенными сообщениями с открытым исходным кодом, совместимая с ICQ, AIM, Yahoo, MSN, IRC, SMTP и другими.</li>
<li><strong>psi</strong>: клиент для jabber.</li>
<li><strong>skype</strong>: программа для совершения телефоноподобных звонков через Интернет другим пользователям Skype. Skype является бесплатным, но не открытым.</li>
<li><strong>Gizmo</strong>: бесплатный (но не открытый) телефон для вашего компьютера</li>
</ul>
<p>.</p>
<h3>Службы новостей</h3>
<p>Запуск сервера Usenet предполагает наличие специальных знаний и тонкой настройки.</p>
<p>Есть несколько интересных новостей в comp.* иерархии, которые можно получить с помощью различных текстовых и графических клиентов. Многие почтовые клиенты также поддерживают просмотр новостей, проверьте вашу программу или обратитесь к локальным зеркалам открытого программного обеспечения за такими текстовыми клиентами, как <strong>tin, slrnn</strong> и <strong>mutt</strong>, или загрузите Mozilla или любой другой графический клиент.</p>
<p>Deja.com хранит архив всех новостей с возможностью поиска, его работа обеспечивается Google. Это очень мощный инструмент для получения помощи: есть большие шансы, что кто-то уже сталкивался с вашей проблемой, нашел решение и отправил его в одну из групп новостей.</p>
<h3>Система доменных имен</h3>
<p>Все эти приложения пользуются службой DNS для сопоставления IP-адреса с именами хоста и обратно. Сервер DNS не знает всех IP-адресов в мире, но он может отправлять запросы на другие сервера DNS для поиска неизвестного адреса. Большинство систем UNIX могут запускать <strong>named</strong>, который является частью пакета BIND (Berkeley Internet Name Domain) распространяемого Internet Software Consortium. Он может работать как автономный кэширующий <em>nameserver</em>, что часто делается на системах Linux для ускорения доступа к сети.</p>
<p>Ваш основной клиентский файл конфигурации — это <span class="mono">/etc/resolv.conf</span>, который определяет порядок, в котором происходит соединение с Domain Name Servers:</p>
<pre>
search somewhere.org
nameserver 192.168.42.1
nameserver 193.74.208.137
</pre><p>Более подробную информацию можно найти в info-страницах для <strong>named</strong>, в файлах <span class="mono">/usr/share/doc/bind[-<version>]</version></span> и на домашней странице проекта Bind. DNS HOWTO описывает использование BIND в качестве сервера DNS.</p>
<h3>DHCP</h3>
<p>DHCP - это протокол динамической настройки хоста, который постепенно заменяет старый добрый <strong>bootp</strong> в больших средах. Он используется для контроля жизненно важных параметров сетей, таких как IP-адресов и серверов имен хостов. DHCP имеет обратную совместимость с <strong>bootp</strong>. Для настройки сервера следует прочитать HOWTO.</p>
<p>DHCP клиентских машин, как правило, конфигурируется с помощью графического интерфейса, который настраивает dhcpcd, клиентский демон DHCP. Проверьте системную документацию, если вам нужно настроить компьютер в качестве клиента DHCP.</p>
<h3>Службы проверки подлинности</h3>
<h4>Традиционный</h4>
<p>Традиционно пользователи проходят проверку подлинности локально, используя информацию, хранящуюся в <span class="mono">/etc/passwd</span> и <span class="mono">/etc/shadow</span> на каждой системе. Но даже при использовании сетевой службы для проверки подлинности, локальные файлы всегда будут присутствовать для настройки системных аккаунтов для административного использования, такого как учетная запись суперпользователя, аккаунты демонов и других программ и целей.</p>
<p>Эти файлы часто являются первыми кандидатами на изучение хакерами, поэтому убедитесь, что права доступа и владельцы установлены именно так, как должно быть:</p>
<pre>
bob:~> <strong>ls -l /etc/passwd /etc/shadow</strong>
-rw-r--r--    1 root     root         1803 Mar 10 13:08 /etc/passwd
-r--------    1 root     root         1116 Mar 10 13:08 /etc/shadow
</pre><h4>PAM</h4>
<p>Linux может использовать PAM, Pluggable Authentication Module, гибкий метод аутентификации в UNIX. Преимущества PAM:</p>
<ul>
<li>Обычная схема аутентификации, которая может использоваться с большим рядом приложений.</li>
<li>PAM может быть реализован с различными приложениями без необходимости перекомпиляции приложений специально для поддержки PAM.</li>
<li>Большая гибкость и контроль над аутентификациями администратора и разработчика приложений.</li>
<li>Разработчикам приложений не требуется создавать свои программы, чтобы использовать определенную схему аутентификации. Вместо этого, они могут сосредоточиться исключительно на деталях своей программы.</li>
</ul>
<p>Каталог <span class="mono">/etc/pam.d</span> содержит конфигурационные файлы PAM (используемые <span class="mono">/etc/pam.conf</span>). Каждое приложение или служба имеют свой собственный файл. Каждая строка в файле состоит из четырех элементов:<br />
Модуль:</p>
<ul>
<li><span class="mono">auth</span>: обеспечивает проверку подлинности (запрашивая и сверяя пароль) и устанавливает учетные данные, такие как членство в группе или тикеты Kerberos.</li>
<li><span class="mono">account</span>: проверяет для уверенности, что доступ разрешен для пользователя (время учетной записи еще не истекло, что пользователь может войти в это время суток, и так далее).</li>
<li><span class="mono">password</span>: используется для установки паролей.</li>
<li><span class="mono">session</span>: используется после того как пользователь прошел аутентификацию. Этот модуль выполняет дополнительные задачи, которые необходимы для разрешения доступа (например, монтирование домашней директории пользователя или имеющегося в наличии почтового ящика).</li>
</ul>
<p>Порядок, в котором расставляются модули такой, чтобы могли использоваться несколько модулей; это является важным.</p>
<ul>
<li><em>Control Flags</em>: сообщают PAM, какие действия предпринять в случае ошибки или удачи. Значения могут быть <span class="mono">required, requisite, sufficient</span> или <span class="mono">optional</span>.</li>
<li><em>Module Path</em>: путь к подключаемый модуль, который будет использоваться, обычно в <span class="mono">/lib/security</span>.</li>
<li><em>Arguments</em>: информация для модулей.</li>
</ul>
<p>Файлы теневых паролей автоматически обнаруживаются PAM.<br />
Более подробную информацию можно найти на man-страницах pam или домашней странице проекта.</p>
<h4>LDAP</h4>
<p>Lightweight Directory Access Protocol является клиент-серверной системой для доступа к глобальной или локальной службам каталогов по сети. В Linux используется реализация OpenLDAP. Она включает в себя <strong>slapd</strong>, отдельный сервер; <strong>slurpd</strong>, автономный сервер репликации LDAP; библиотеки, реализующие протокол LDAP, а также ряд утилит, инструментов и примеров клиентов.</p>
<p>Главным преимуществом использования LDAP является консолидация отдельных видов информации в пределах организации. Например, все разные списки пользователей в вашей организации могут быть объединены в один LDAP-каталог. Этот каталог может быть запрошен любым LDAP-приложением, которому необходима эта информация. Она также может быть доступна пользователям.</p>
<p>Другие преимущества LDAP или X.500 Lite заключаются в его простоте реализации (по сравнению с X.500) и его четко определенном Application Programming Interface (API), что означает, что число LDAP-приложений с поддержкой LDAP и шлюзов увеличиться в будущем.</p>
<p>Однако есть и другая сторона. Если вы хотите использовать LDAP, вам потребуются LDAP-приложения или возможность использования LDAP-шлюзов. Хотя использование LDAP должно только возрастать, в настоящее время существует не так много LDAP-приложений для Linux. Кроме того, хотя LDAP поддерживает некоторый контроль доступа, он не обладает теми многими функциями безопасности, как X.500.</p>
<p>Так как LDAP является открытым и настраиваемый протоколом, он может быть использован для хранения практически любой информации, относящейся к конкретной организационной структуре. Типичными примерами являются поиск почтовых адресов, централизованная аутентификация в сочетании с PAM, телефонные справочники и базы данных конфигурации компьютера.</p>
<p>Посмотрите вашу системную информацию и man-страницы связанных команд, таких как <strong>ldapmodify</strong> и <strong>ldapsearch</strong> для выяснения деталей. Более подробную информацию можно найти в LDAP Linux HOWTO, в котором обсуждается установка, настройка, запуск и обслуживание LDAP-сервера на Linux. </p>
  </div>
<div id="node-315" class="section-3">
  <h1 class="book-heading">Удаленное выполнение приложений</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<h3>Введение</h3>
<p>Существует несколько различных способов выполнения команд или запуска программ на удаленном компьютере, а также получение результатов их работы на рабочей станции, будь то текст или графика. Связь может быть безопасной или нет. Хотя советуют использовать защищенное соединение, а не транспортировать пароль по сети в открытом виде, мы обсудим некоторые практические приложения, использующие более старые (небезопасные) механизмы, т.к. они все еще полезны в современной сетевой среде, например, для устранения неполадок или работы экзотических программ.</p>
<h3>Rsh, rlogin и telnet</h3>
<p>Команды для удаленного входа и выполнения команд <strong>rlogin</strong> и <strong>rsh</strong> пришли из UNIX. Хотя они редко используются, т.к. это небезопасно, они по-прежнему поставляются почти с каждым дистрибутивом для обратной совместимости с UNIX-программами.</p>
<p>Кроме того, <strong>telnet</strong> по-прежнему широко используется системными и сетевыми администраторами. Telnet является одним из наиболее мощных инструментов для удаленного доступа к файлам и удаленного администрирования, позволяющий устанавливать связь из любой точки мира через Интернет. В сочетании с X-сервером, удаленные графические приложения могут быть отображены на локальной машине. В результате стираются границы между работой на локальном компьютере и с помощью удаленной машины.</p>
<p>По причине того, что всё соединение не зашифровано, позволяя <strong>telnet</strong> соединяться, вы берете на себя высокие риски, связанные с безопасностью. Для нормального удаленного выполнения программ рекомендуется использовать Secure Shell, или <strong>ssh</strong>. Далее мы будем обсуждать безопасный метод связи.</p>
<p>Однако, во многих случаях <strong>telnet</strong> до сих пор используется. Ниже приведены некоторые примеры, в которых почтовый сервер и веб-сервер тестируются на ответы.</p>
<p>Проверка того, что почтовый сервер работает:</p>
<pre>
[jimmy@blob ~] <strong>telnet mailserver 25</strong>
Trying 192.168.42.1...
Connected to mailserver.
Escape character is '^]'.
220 m1.some.net ESMTP Sendmail 8.11.6/8.11.6; 200302281626
<strong>ehlo some.net</strong>
250-m1.some.net Hello blob.some.net [10.0.0.1], pleased to meet you
250-ENHANCEDSTATUSCODES
250-8BITMIME
250-SIZE
250-DSN
250-ONEX
250-ETRN
250-XUSR
250 HELP
mail from: <strong>jimmy@some.net</strong>
250 2.1.0 jimmy@some.net... Sender ok
rcpt to: <strong>davy@some.net</strong>
250 2.1.5 davy@some.net... Recipient ok
<strong>data</strong>
354 Enter mail, end with "." on a line by itself
<strong>test</strong>
.
250 2.0.0 g2MA1R619237 Message accepted for delivery
<strong>quit</strong>
221 2.0.0 m1.some.net closing connection
Connection closed by foreign host.
</pre><p>Проверка того, что веб-сервер отвечает на основные запросы:</p>
<pre>
[jimmy@blob ~] <strong>telnet www.some.net 80</strong>
Trying 64.39.151.23...
Connected to www.some.net.
Escape character is '^]'.
<strong>HEAD / ;HTTP/1.1</strong>

HTTP/1.1 200 OK
Date: Fri, 22 Mar 2002 10:05:14 GMT
Server: Apache/1.3.22 (UNIX) (Red-Hat/Linux) 
 mod_ssl/2.8.5 OpenSSL/0.9.6
 DAV/1.0.2 PHP/4.0.6 mod_perl/1.24_01
Last-Modified: Fri, 04 Jan 2002 08:21:00 GMT
ETag: "70061-68-3c3565ec"
Accept-Ranges: bytes
Content-Length: 104
Connection: close
Content-Type: text/html

Connection closed by foreign host.

[jimmy@blob ~]
</pre><p>
Это совершенно безопасно, потому что вы нигде не вводите имя пользователя и/или пароль для получения данных, которые вам требуются, поэтому никто не сможет стащить какую-нибудь важную информацию с кабеля.</p>
<h3>X Window System</h3>
<h4>Особенности X</h4>
<p>Как мы уже объясняли в Главе 7, система X Window поставляется с Х-сервером, который обслуживает графические приложения клиентов.</p>
<p>Важно понимать различие между X-сервероми и клиентскими X-приложениями. Х-сервер управляет дисплеем напрямую и несет ответственность за все входящие и выходящие данные, которые проходят через клавиатуру, мышь и монитор. X-клиент, со своей стороны, не имеет доступа к устройствам ввода и вывода напрямую. Он связывается с X-сервером, который обрабатывает ввод и вывод. X-клиент выполняет реальную работу, такую как вычисления значений, обеспечивает работу приложений и т.д. Х-сервер только открывает окна для обработки ввода и вывода для конкретного клиента.</p>
<p>При обычной работе (в графическом режиме), каждая рабочая станция Linux является X-сервером для себя самой. Все приложения, которые вы используете (например, Gimp, окно терминала, браузер, офисное приложение, инструмент проигрывания CD и т.д.) являются клиентами вашего X-сервера. Получается, что сервер и клиент работают на одной машине.</p>
<p>Такая клиент/серверная особенность системы X делает ее идеальной средой для удаленного выполнения приложений и программ. Поскольку процесс реально выполняется на удаленной машине, требуется мало мощности процессора на локальном хосте. Такие машины, которые работают только как сервера для X, называют X-терминалами и когда-то они были очень популярны.</p>
<h4>Telnet и X</h4>
<p>Если бы вы захотели использовать <strong>telnet</strong> для отображения графических приложений, работающих на удаленном компьютере, необходимо сначала дать удаленному компьютеру доступ к вашему дисплею (теперь уже X-серверу!)  используя команду <strong>xhost</strong>, набрав ее как в примере ниже в окне терминала на вашем локальном компьютере:</p>
<pre>
davy:~> <strong>xhost +remote.machine.com</strong>
</pre><p>После этого, надо подключиться к удаленному хосту и сообщить ему об отображении графики на локальной машине, установив переменную окружения:</p>
<pre>
[davy@remote ~] <strong>export DISPLAY="local.host.com:0.0"</strong>
</pre><p>После завершения этого шага, любое приложение, запущенное в этом окне терминала будет отображаться на вашем локальном компьютере, используя удаленные ресурсы для вычислений, но ваши местные графические ресурсы (Ваш X-сервер) для отображения приложений.</p>
<p>Эта процедура предполагает, что у вас на компьютере уже установлены какие-нибудь X-сервера (XFree86, X.org, Exceed, Cygwin), и вам есть с помощью чего отображать изображения. Архитектура и операционная система клиентского компьютера не важны, если они позволяют запускать на нем Х-сервер.</p>
<p>Помните, что отображение окна терминала с удаленной машины также считается прорисовкой изображения.</p>
<h3>Пакет SSH</h3>
<h4>Введение</h4>
<p>Большинство систем UNIX и Linux в настоящее время запускают Secure SHell, чтобы избежать рисков для безопасности, которые давал <strong>telnet</strong>. На большинстве систем Linux будет работать версия OpenSSH, открытая реализация протокола SSH, обеспечивающая безопасную зашифрованную связь между непроверенными хостами в ненадежной сети. X-соединения при обычной установке автоматически передаются, но произвольные TCP/IP порты могут также быть переданы с использованием защищенного канала.</p>
<p>Клиент <strong>ssh</strong> подключается и регистрируется на указанном имени хоста. Пользователь должен предоставить данные о себе на удаленной машине, как указано в файле <span class="mono">sshd_config</span>, который обычно можно найти в <span class="mono">/etc/ssh</span>. Содержимое конфигурационного файла говорит само за себя, и по умолчанию включает наиболее используемы возможности. Если вам нужна помощь, вы сможете найти ее в man-страницах <strong>sshd</strong>.</p>
<p>Когда личность пользователя становится идентифицированной сервером, он либо выполняет данную команду, либо заходит на компьютер и предоставляет пользователю обычный shell на удаленной машине. Вся связь с удаленной командой или оболочкой будет автоматически зашифрована.</p>
<p>Сессия заканчивается, когда команда или оболочка на удаленной машине завершает работу, и все X11 и TCP/IP соединения оказываются закрытыми.</p>
<p>При подключении к хосту в первый раз, используя любую из программ, которые включены в коллекцию SSH, необходимо установить подлинность этого хоста и подтвердить, что вы хотите подключиться:</p>
<pre>
lenny ~> <strong>ssh blob</strong>
The authenticity of host 'blob (10.0.0.1)' can't be established.
RSA fingerprint is 18:30:50:46:ac:98:3c:93:1a:56:35:09:8d:97:e3:1d.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'blob,192.168.30.2' (RSA) to the list of 
known hosts.
Last login: Sat Dec 28 13:29:19 2002 from octarine
This space for rent.

lenny is in ~
</pre><p>Важно, чтобы вы ввели "yes", из трех символов, а не только "у". Все это изменяет ваш файл <span class="mono">~/.ssh/known_hosts</span>, см. <a href="http://younglinux.info/#">Раздел "Проверка подлинности сервера"</a>.</p>
<p>Если вы просто хотите проверить что-то на удаленной машине, а затем вернуться обратно к оболочке на локальном компьютере, вы можете передать команды, которые вы хотите выполнить удаленно, в качестве аргументов <strong>ssh</strong>:</p>
<pre>
lenny ~> <strong>ssh blob who</strong>
jenny@blob's password:
root     tty2         Jul 24 07:19
lena	 tty3         Jul 23 22:24
lena     0:	      Jul 25 22:03

lenny ~> <strong>uname -n</strong>
magrat.example.com
</pre><h4>Пересылка X11 и TCP</h4>
<p>Если параметру <span class="mono">X11Forwarding</span> присвоено значение yes на требуемом компьютере и пользователь использует X-приложения, устанавливается переменная среды <span class="mono">DISPLAY</span>, подключение к X11-дисплею автоматически пересылаются на удаленный сервер таким образом, что любая X11-программа, запускаемая из оболочки, будет проходить через шифрованный канал, и связь с реальным X-сервером будет создана из локальной машине. Пользователю. не надо вручную устанавливать <span class="mono">DISPLAY</span>. Отправка X11-соединений может быть сконфигурирована в командной строке или в конфигурационном файле <strong>sshd</strong>. </p>
<p>Значение для <span class="mono">DISPLAY</span>, установленное <strong>ssh</strong>, будет указывать на сервер, но с номером дисплея больше нуля. Это нормально и происходит потому, что ssh создает proxy X сервер на сервере (который запускает X-приложение клиента) для пересылки соединений через зашифрованный канал.</p>
<p>Все это делается автоматически, так что, когда вы набираете название графического приложения, оно отобразиться на вашем локальном компьютере, а не на удаленном хосте. В примере мы используем <strong>xclock</strong>, так как это небольшая программа, которая обычно установлена и идеально подходит для тестирования:</p>
<p><strong>Рисунок 10.3. SSH X11 перенаправление</strong><br />
<img src="../../../img/linuxintro/ssh_X11.png" width="509" height="368" alt="Команда ssh" /></p>
<p>SSH также автоматически настроит X-полномочия на сервере. Для этой цели будут  сгенерированы случайные авторизационные куки, SSH сохранит их на сервере и проверит, что какое-либо соединение несет эти куки и заменит их реальными, когда соединение будет установлено. Реальные аутентификационные куки никогда не передается на сервер (и никакие куки не отправляются так как есть).</p>
<p>Пересылка произвольных TCP/IP-соединений через защищенный канал может быть определена либо в командной строке, либо в файле конфигурации.</p>
<p class="note"><img src="../../../img/linuxintro/note.gif" alt="" /><strong> Х-сервер</strong><br />
Эта процедура предполагает, что у вас работает Х-сервер на стороне клиента, где вы отображаете приложение от удаленного хоста. Клиент может иметь иную архитектуру и операционную систему, чем удаленный хост в том случае, если он может запустить Х-сервер, например, Cygwin (который реализует X.org сервер для клиентов MS Windows и др.) или Exceed, должна быть возможность настроить удаленное соединение с любым компьютером Linux или Unix.</p>
<h4>Проверка подлинности сервера</h4>
<p>Клиент/серверная система <strong>ssh</strong> автоматически поддерживает и проверяет базу данных, содержащую идентификационную информация для всех хостов, которые  когда-либо использовались. Ключи хостов хранятся в <span class="mono">$HOME/.ssh/known_hosts</span>, который находится в домашнем каталоге пользователя. Кроме того, автоматически проверяется файл <span class="mono">/etc/ssh/ssh_known_hosts</span> на наличие известных хостов. Любые новые хосты, автоматически добавляются в файл пользователя. Если идентификация хоста когда-либо изменяется, <strong>ssh</strong> предупреждает об этом и отключает аутентификацию по паролю, чтобы какой-нибуль троянский конь не получил пароля пользователя. Другая цель этого механизма заключается в предотвращении "человек-в-середине" атаки, которые могут быть использованы для обхода шифрования. В средах, где необходим высокий уровень безопасности, <strong>sshd</strong> даже может быть настроен для предотвращения входов на машины, чьи ключи хоста были изменены или неизвестны.</p>
<h4>Безопасное удаленное копирование</h4>
<p>Пакет SSH предоставляет <strong>scp</strong> в качестве безопасной альтернативой команды <strong>rcp</strong>, которая была популярна, когда только она и существовала. <strong>scp</strong> использует <strong>ssh</strong> для передачи данных, использует ту же самую проверку подлинности и обеспечивает такую же безопасность как <strong>ssh</strong>. В отличие от <strong>rcp</strong>, <strong>scp</strong> будет запрашивать пароль или парольную фразу, если они необходимы для аутентификации:</p>
<pre>
lenny /var/tmp> <strong>scp Schedule.sdc.gz blob:/var/tmp/</strong>
lenny@blob's password:
Schedule.sdc.gz  100% |*****************************| 100 KB 00:00

lenny /var/tmp>
</pre><p>Любое имя файла может содержать хост и спецификации пользователя для указания, что файл должен быть скопирован на/с этого хоста. Копии между двумя удаленными хостами не допускаются. См. info-страницы для получения дополнительной информации.</p>
<p>Если вы предпочитаете использовать FTP-подобный интерфейс, используйте <strong>sftp</strong>:</p>
<pre>
lenny /var/tmp> <strong>sftp blob</strong>
Connecting to blob...
lenny@blob's password:
<strong></strong>
sftp> <strong>cd /var/tmp</strong>

sftp> <strong>get Sch*</strong>
Fetching /var/tmp/Schedule.sdc.gz to Schedule.sdc.gz

sftp> <strong>bye</strong>

lenny /var/tmp>
</pre><p class="note"><img src="../../../img/linuxintro/note.gif" alt="" /><strong>Безопасное копирование или FTP GUI</strong><br />
Еще не чувствуйте себя комфортно в командной строке? Попробуйте возможности Konqueror для безопасного удаленного копирования, или установите Putty.</p>
<h4>Проверка подлинности ключей</h4>
<p>Команда <strong>ssh-keygen</strong> создает, управляет и преобразует ключи аутентификации для <strong>ssh</strong>. Она может создавать ключи RSA для использования протоколом SSH версии 1 и ключи RSA или DSA для использования протоколом SSH версии 2.</p>
<p>Обычно каждый пользователь, желающий использовать SSH с аутентификацией RSA или DSA, выполняет команду единожды для создания ключей аутентификации в <span class="mono">$HOME/.ssh/identity, id_dsa</span> или <span class="mono">id_rsa</span>. Кроме того, системный администратор может использовать ее для генерации ключей хоста системы.</p>
<p>Обычно эта программа генерирует ключ и опрашивает файл, в котором он хранится. Открытый ключ хранится в файле с тем же именем, но добавляется расширение <em>.pub</em>. Также программа запрашивает пароль. Пароль может быть пустым, что указывает на то, что его нет (ключи хостов должно быть с пустым паролем), или это может быть строка произвольной длины.<br />
Не существует способа восстановить потерянный пароль. Если фраза утеряна или забыта, новый ключ должен быть создан и скопирован в соответствующие открытые ключи.</p>
<p>Мы изучим ключи SSH в упражнениях. Вся информация может быть найдена в man- или info-страницах.</p>
<h3>VNC</h3>
<p>VNC или Virtual Network Computing, на самом деле система удаленного дисплея, которая позволяет просматривать рабочую среду не только на локальной машине, на которой он запущен, но и из любой точки Интернет и с самых разных машин и архитектур, в том числе MS Windows и некоторых дистрибутивов UNIX. Можно, например, запустить MS Word на компьютере с Windows NT и отобразить результ на вашем рабочем столе Linux. VNC обеспечивает серверы также как клиентов, поэтому противоположное также работает, что можно использовать для отображения Linux программ для клиентов Windows. VNC, вероятно, самый простой способ получить X соединения на ПК. Следующие характеристики показывают, чем VNC отличается от обычного Х-сервера или коммерческих реализаций:</p>
<ul>
<li>Ни одно состояние не хранится на стороне зрителя: вы можете покинуть свой стол и возобновить работу с другого компьютера с того места, где вы остановились. Когда вы запускаете X-сервер, а также происходят сбои или перезагрузки ПК, то все удаленные приложения, которые вы запустили, прекращают работать. А вот VNC они продолжат свое выполнение.</li>
<li>Это маленькая и простая программа, не требующая установки; если потребуется, может быть запущена с дискеты.</li>
<li>Платформенно независима с Java-клиентом, работает в виртуальной среде, которая поддерживает X.</li>
<li>Разделяема: один рабочий стол может отображаться на множество зрителей.</li>
<li>Свободна.</li>
</ul>
<p>Более подробную информацию можно найти на man-страницах (<strong>man <span class="monoi">vncviewer</span></strong>) или на веб-сайте VNC.</p>
<h3>Протокол rdesktop</h3>
<p>Для того, чтобы облегчить управление хостами MS Windows, новые дистрибутивы Linux поддерживают Remote Desktop Protocol (RDP), который реализован в клиенте <strong>rdesktop</strong>. Протокол используется в ряде продуктов Microsoft, включая Windows NT Terminal Server, Windows 2000 Server, Windows XP и Windows 2003 Server.</p>
<p>Руководство <strong>man <span class="monoi">rdesktop</span></strong> предоставляет больше информации.</p>
<h3>Cygwin</h3>
<p>Cygwin обеспечивает существенную функциональность UNIX на системах MS Windows. Помимо предоставления утилит командной строки UNIX и графических приложений, она также может быть использована для отображения рабочего стола Linux на компьютере с MS Windows, с помощью удаленного X. Из оболочки Bash Cygwin, введите команду</p>
<p><span class="mono">/usr/X11R6/bin/XWin.exe -query your_linux_machine_name_or_IP</span></p>
<p>Соединение по умолчанию запрещено. Вы должны изменить конфигурацию X Display Manager (XDM) и, возможно, конфигурацию X Font Server (XFS), чтобы включить этот тип соединения, где вы получите экран входа на удаленной машине. В зависимости от вашего менеджер рабочего стола (Gnome, KDE, другие), вам, возможно, придется изменить некоторые настройки и там.</p>
<p>Если вам не нужно отображать весь десктоп, вы можете использовать SSH в Cygwin, так же, как описано в <a href="http://younglinux.info/#">Разделе "Пакет SSH"</a>, без всякой суеты по редактированию конфигурационных файлов.</p>
  </div>
<div id="node-316" class="section-3">
  <h1 class="book-heading">Безопасность</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<h3>Введение</h3>
<p>Как только компьютер оказывается подключен к сети, то становится возможным его злонамеренное использование независимо от операционной системы, установленной на нем. Много слов написано на эту тему, и это завело бы нас слишком далеко, если бы мы стали обсуждать вопросы безопасности в деталях. Есть, однако, несколько довольно логичных вещей, которые может сделать даже начинающий пользователь, чтобы получить достаточно безопасную систему, потому что большинство взломов является результатом невежественности или беспечности пользователей.</p>
<p>Возможно, вы не знаете, относится ли это к вашему домашнему или рабочему компьютеру. Вопросы, которые вам следует задать себе, должны быть следующими:</p>
<ul>
<li>Вы хотите иметь контроль над собственной системой?</li>
<li>Хотите ли вы (невольно) участвовать в преступной деятельности?</li>
<li>Вы хотите, чтобы ваше оборудование использовалось кем-то другим?</li>
<li>Вы хотите иметь возможность потерять подключение к Интернет?</li>
<li>Вам нравится восстанавливать вашу систему каждый раз, когда она была взломана?</li>
<li>Вы хотите рисковать потерять личные или иные данные?</li>
</ul>
<p>Предположим, что вы всего этого не хотите; мы распишем несколько шагов, которые вы можете предпринять для защиты вашей машины.</p>
<h3>Службы</h3>
<p>Цель состоит в том, чтобы работало как можно меньше служб. Если количество портов, открытых для внешнего мира, было сведено к минимуму, то это облегчит слежение. Если службы не могут быть отключены в локальной сети, постарайтесь хотя бы отключить их для внешних подключений.</p>
<p>Эмпирическое правило таково, что если вы не узнаете конкретную службу, вы, вероятно, не нуждаетесь в ней. Также имейте в виду, что некоторые службы на самом деле не предназначены для использования через Интернет. Не полагайтесь на то, что запущено все, что должно быть запущено, проверьте, какие сервисы прослушиваются на  TCP-портах, используя команду <strong>netstat</strong>:</p>
<pre>
[elly@mars ~] <strong>netstat -l | grep tcp</strong>
tcp     0      0 *:32769                 *:*      LISTEN
tcp     0      0 *:32771                 *:*      LISTEN
tcp     0      0 *:printer               *:*      LISTEN
tcp     0      0 *:kerberos_master       *:*      LISTEN
tcp     0      0 *:sunrpc                *:*      LISTEN
tcp     0      0 *:6001                  *:*      LISTEN
tcp     0      0 *:785                   *:*      LISTEN
tcp     0      0 localhost.localdom:smtp *:*      LISTEN
tcp     0      0 *:ftp                   *:*      LISTEN
tcp     0      0 *:ssh                   *:*      LISTEN
tcp     0      0 ::1:x11-ssh-offset      *:*      LISTEN
</pre><p>Чего следует избегать:</p>
<ul>
<li><strong>exec, rlogin, rsh</strong> и <strong>telnet</strong> просто на всякий случай.</li>
<li>X11 на серверах.</li>
<li>Отсутствие lp, если ни один принтер физически подключен.</li>
<li>Нет MS Windows хостов в сети, не требуется Samba.</li>
<li>Не допускайте FTP, если сервер FTP не требуется.</li>
<li>Не позволяйте NFS и NIS через Интернет, отключите все сопутствующие службы на автономной установке.</li>
<li>Не запускать MTA, если вы не находитесь на почтовом сервере.</li>
<li>...</li>
</ul>
<p>Остановите запущенные службы с помощью команды <strong>chkconfig</strong>, скриптов init или путем редактирования конфигурационного файла <strong>(x)inetd</strong>.</p>
<h3>Регулярное обновление</h3>
<p>Способность быстро адаптироваться в постоянно меняющейся среде позволяет Linux процветать. Но это также создает вероятность того, что обновления безопасности выпускаются после того, как вы установили новую версию дистрибутива; поэтому первое, что нужно сделать (и это относится к любой ОС) после установки — получить и установить все доступные обновления. </p>
<p>Некоторые обновления могут потребоваться новые конфигурационные файлы, а старые файлы могут быть заменены. Проверьте документацию и убедитесь, что все работает нормально после обновления.</p>
<p>Большинство Linux дистрибутивов предлагают сервисы списков рассылки для уведомления об обновлении безопасности и инструменты для применения обновлений к системе. </p>
<p>Обновление представляет собой непрерывный процесс, поэтому происходит почти ежедневно.</p>
<h3>Брандмауэры и политики доступа</h3>
<h4>Что такое брандмауэр (фаервол)?</h4>
<p>В предыдущем разделе мы уже упоминали возможности брандмауэра (межсетевого экрана) в Linux. Хотя управление им является одной из задач вашего сетевого администратора, вы должны знать некоторые вещи о фаерволах.</p>
<p>Брандмауэр - не четко определенный термин, он может означать все, что действует как защитный барьер между нами и внешним миром, как правило, Интернет. Брандмауэр может быть встроенным в систему или отдельным приложением, которое обеспечивает подобную функциональность. Или это может быть сочетание компонентов, в том числе различные комбинации аппаратного и программного обеспечения. Межсетевые экраны построены из "правил", которые используются для определения того, чему позволено входить и/или выходить на данной системе или в сети.</p>
<p>После отключения ненужных служб, мы должны ограничить запущенные службы таким образом, чтобы позволить им только минимально необходимые соединения. Прекрасным примером является работа на дому:  должно быть разрешено только строго определенное соединение между вашими офисом и дом, соединения с другими машинами в сети Интернет должны быть заблокированы.</p>
<h4>Пакетные фильтры</h4>
<p>Первой линией обороны является пакетный фильтр, который может просматривать содержимое IP-пакетов и принимать решения исходя из их содержания. Самым популярным является пакет Netfilter, предоставляющий команду <strong>iptables</strong>, следующее поколение пакетных фильтров для Linux.</p>
<p>Один из самых примечательных усовершенствований в новых ядрах является способность проверять сохранность состояния, при этом сообщается не только о том, что находится внутри пакета, но и обнаруживается, если пакет принадлежит или связан с новым или существующим соединением.</p>
<p>Shoreline Firewall или Shorewall представляет собой интерфейс для доступа к стандартной функциональности брандмауэра в Linux.</p>
<h4>Обертки TCP</h4>
<p>Упаковка TCP обеспечивает во многом такие же результаты, как и фильтры пакетов, но работает по-другому. Обертка принимает попытки подключения, а затем проверяет файлы конфигурации и решает, следует ли принять или отклонить запрос на соединение. Она контролирует соединения на уровне приложений, а не на сетевом уровне.</p>
<p>TCP-обертки, как правило, используются с <strong>xinetd</strong> для предоставления имени хоста и основанном на IP-адресе управлении доступа. Кроме того, эти инструменты включают регистрацию и использование возможностей управления, которые легко настроить.</p>
<p>Преимущества оболочек TCP в том, что подключившийся клиент не знает, что используются обертки, и что они работают отдельно от приложений, которые они защищают.</p>
<p>На хосте доступ контролируется в файлах <span class="mono">hosts.allow</span> и <span class="mono">hosts.deny</span>. Более подробную информацию можно найти в файлах документации обертки TCP в <span class="mono">/usr/share/doc/tcp_wrappers[-<version>/]</version></span> или <span class="mono">/usr/share/doc/tcp</span> и в man-страницах для файлов контроля доступа хоста, там же содержатся примеры.</p>
<h4>Прокси</h4>
<p>Прокси-серверы могут выполнять различные задачи, и не все из них имеют непосредственное отношение к безопасности. Однако эти службы являются промежуточным звеном, которое делает прокси прекрасным местом для применения политики управления доступом, ограничения прямого соединения через брандмауэр и контроля того, как сеть после прохождения через прокси выглядит в Интернет.</p>
<p>Обычно в сочетании с пакетным фильтром, но иногда и сами по себе, прокси-серверы обеспечивают дополнительный уровень контроля. </p>
<h4>Доступ к отдельным приложениям</h4>
<p>Некоторые серверы могут иметь свои собственные средства контроля доступа. Например, Samba, X Window, Bind, Apache и CUPS. Для каждой службы используются определенные файлы конфигурации.</p>
<h4>Файлы журналов</h4>
<p>Во всяком случае UNIX-путь фиксации всех видов деятельности на всех видах файлов подтверждает, что "это что-то делает". Конечно, файлы журналов должны регулярно проверяться вручную или автоматически. Межсетевые экраны и другие средства контроля доступа, как правило, создают огромное количество log-файлов, так что проблема заключается в том, чтобы попытаться найти в них только ненормальную активность.</p>
<h3>Обнаружение вторжений</h3>
<p>Системы обнаружения вторжений (Intrusion Detection Systems - IDS) предназначены поймать то, что, возможно, пропустил брандмауэр. Они могут также быть предназначены для улавливания активной попытки взлома или для обнаружения уже свершившегося вторжения. В последнем случае уже слишком поздно, чтобы предотвратить любое повреждение, но по крайней мере мы осознали проблему на ранней стадии. Существуют два основных типа IDS: защищающие сети и защищающие индивидуальные хосты.</p>
<p>IDS хостов представляют собой утилиты, которые следят за файловой системой на предмет изменений. Системные файлы, которые так или иначе изменились, но не должны были меняться, привлекают к себе внимание. Это говорит о том, что кто-то вошел в систему с правами администратора, и вносит системные изменения. </p>
<p>Обнаруженное вторжений обрабатывается системой, которая видит весь трафик, который пропускает брандмауэр.</p>
<h3>Дополнительные советы</h3>
<p>Некоторые общеизвестные факты, которые следует иметь в виду:</p>
<ul>
<li>Не входите в систему как администратор. Разработчики UNIX более двух десятилетий назад придумали команду <strong>su</strong> для дополнительной безопасности.</li>
<li>Прямой доступ root всегда опасен и допускает человеческие ошибки, и не важно входите ли вы в систему как root или используете команду su. Поэтому вместо использования <strong>su</strong>, лучше использовать <strong>sudo</strong> для выполнения тех команд, которые требуют привилегий, и возвращаться потом к своей среде.</li>
<li>Относитесь к паролям серьезно. Используйте теневые пароли. Регулярно изменяйте пароли.</li>
<li>Старайтесь всегда использовать SSH или SSL. Избегайте <strong>telnet</strong>, FTP, E-mail клиентов и других клиентских программ, которые отправляют незашифрованные пароли по сети. Важно не только обеспечить безопасность вашего компьютера, но и безопасность ваших паролей.</li>
<li>Ограничьте ресурсы с помощью <strong>quota</strong> и/или <strong>ulimit</strong>.</li>
<li>Проверяйте подлинность нового ПО, берите его из надежного места/сайта. Проверьте новые пакеты перед установкой.</li>
<li>При использовании непостоянного подключения к Интернет, отключайте его, как только вам оно больше не нужно.</li>
<li>Запускайте личные службы на незанятых портах, а не тех, которые ожидают возможных атак хакеров.</li>
<li>Знайте вашу систему. Спустя какое-то время вы сможете почти чувствовать, когда что-то происходит.</li>
</ul>
<h3>Меня хакнули?</h3>
<p>Как вы можете об этом догадаться? Это контрольный список подозрительных событий:</p>
<ul>
<li>Таинственные открытые порты, странные процессы.</li>
<li>Системные утилиты (часто используемые команды) ведут себя странно.</li>
<li>Войти в систему проблемно.</li>
<li>Необъяснимое использование пропускной способности сети.</li>
<li>Поврежденные или отсутствующие файлы журналов, странное поведение демона syslog.</li>
<li>Интерфейсы в необычных режимах.</li>
<li>Неожиданно изменение конфигурационных файлов.</li>
<li>Странные записи в файлы истории оболочки.</li>
<li>Неизвестные временные файлы.</li>
</ul>
<h3>Восстановление после вторжения</h3>
<p>Итак, сохраняйте спокойствие. Затем выполните следующие действия в указанном порядке:</p>
<ul>
<li>Отключите компьютер от сети.</li>
<li>Постарайтесь выяснить, насколько это возможно то, каким образом безопасность была нарушена.</li>
<li>Создайте резервную копию важных несистемных данных. Если это возможно, сравните эти данные с существующими резервными копиями, сделанными до того как системы была взломана, для обеспечения целостности данных.</li>
<li>Переустановите систему.</li>
<li>Используйте новые пароли.</li>
<li>Восстановление резервные копии данных.</li>
<li>Примените все доступные обновления.</li>
<li>Пересмотреть систему: заблокируйте ненужные службы, проверьте правила брандмауэра и другие политики доступа.</li>
<li>Подключитесь к сети.</li>
</ul>
  </div>
<div id="node-317" class="section-3">
  <h1 class="book-heading">Резюме</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<p>Linux и сети развиваются совместно. Ядро Linux включает поддержку всех распространенных и самых необычных сетевых протоколов. Стандартные сетевые инструменты UNIX предоставляются с каждым дистрибутивом. Наряду с этим, большинство дистрибутивов предлагают инструменты для легкой установки и управления сетью.</p>
<p>Linux известен как стабильная платформа для запуска различных сервисов Интернет, количество его интернет-программы бесконечно. Как и UNIX, Linux может быть также использоваться и управляться в удаленном режиме, используя одно из нескольких решений для удаленного выполнения программ.</p>
<p>Мы кратко затронули тему безопасности. Linux является идеальной системой с межсетевым экраном, легким и дешевым, а также может использоваться для других сетевых функций, таких как маршрутизаторы и прокси-серверы.</p>
<p>Увеличение безопасности сети в основном осуществляется путем применения регулярных обновлений и здравого смысла.</p>
<p>Вот краткий обзор команд, связанных с работой в сети:</p>
<p><strong>Таблица 10.2. Новые команды из главы 10: Сеть</strong></p>
<table>
<tr>
<td width="150"><strong>Команда</strong></td>
<td><strong>Значение</strong></td>
</tr>
<tr>
<td><strong>ftp</strong></td>
<td>Передача файлов на другой компьютер (небезопасная).
</td>
</tr>
<tr>
<td><strong>host</strong></td>
<td>Получение информации о компьютерах в сети.</td>
</tr>
<tr>
<td><strong>ifconfig</strong></td>
<td>Вывод на экран IP-адресов.</td>
</tr>
<tr>
<td><strong>ip</strong></td>
<td>Вывод на экран IP-адресов.</td>
</tr>
<tr>
<td><strong>netstat</strong></td>
<td>Отображает информацию о маршрутизации и сетевую статистику.</td>
</tr>
<tr>
<td><strong>ping</strong></td>
<td>Отправка запросов на другие узлы сети и получение ответов.</td>
</tr>
<tr>
<td><strong>rdesktop</strong></td>
<td>Отображение информации о компьютерах с MS Windows на Linux-машине.</td>
</tr>
<tr>
<td><strong>route</strong></td>
<td>Показать информацию о маршрутизации.</td>
</tr>
<tr>
<td><strong>scp</strong></td>
<td>Безопасное копирование файлов на/с другого компьютера.</td>
</tr>
<tr>
<td><strong>sftp</strong></td>
<td>Безопасное ftp-соединение.</td>
</tr>
<tr>
<td><strong>ssh</strong></td>
<td>Создание зашифрованного соединения с другим хостом.</td>
</tr>
<tr>
<td><strong>ssh-keygen</strong></td>
<td>Генерация ключей аутентификации для Secure SHell.
</td>
</tr>
<tr>
<td><strong>telnet</strong></td>
<td>Создание небезопасного соединения с другим хостом.</td>
</tr>
<tr>
<td><strong>tracepath/traceroute</strong></td>
<td>Вывод маршрута, которым пакеты следуют на другой узел.</td>
</tr>
<tr>
<td><strong>whois</strong></td>
<td>Получение информации об имени домена.</td>
</tr>
<tr>
<td><strong>xclock</strong></td>
<td>Приложение часов X Window, удобно для тестирования удаленного дисплея.</td>
</tr>
<tr>
<td><strong>xhost</strong></td>
<td>X Window инструмент контроля доступом.</td>
</tr>
</table>
  </div>
<div id="node-318" class="section-3">
  <h1 class="book-heading">Упражнения</h1>
  <p class="right">Introduction to Linux. A Hands on Guide —<br />
Введение в Linux. Руководство по работе</p>
<h3>Основы сетей</h3>
<ul>
<li>Отобразите сетевую информацию для вашей рабочей станции: IP-адрес, маршруты, имена серверов.</li>
<li>Предположим, что отсутствует DNS. Что бы вы сделали, чтобы получать доступ к машине соседа без постоянного ввода IP-адреса?</li>
<li>Как бы вы надолго сохранили информацию о прокси для браузера текстового режима, такого как <strong>links</strong>?</li>
<li>Какие серверы управляются доменом redhat.com?</li>
<li>Отправить E-mail в вашу локальную учетную запись. Попробуйте два различных способа отправлять и читать ее. Как вы можете убедиться, что письмо действительно пришло?</li>
<li>Ваша машина принимает анонимные FTP-соединения? Как вы используете программу <strong>ncftp</strong> для проверки вашего имени пользователя и пароля?</li>
<li>На компьютере работает веб-сервер? Если нет, запустите его. Проверьте файлы журналов.</li>
</ul>
<h3>Удаленные подключения</h3>
<ul>
<li>С вашего компьютера отобразите графическое приложение, например, <strong>xclock</strong> на экране вашего соседа. Должны быть созданы необходимые учетные записи. Используйте безопасное соединение!</li>
<li>Настройте ключи SSH так, чтобы вы смогли подключиться к компьютеру соседа без необходимости ввода пароля.</li>
<li>Сделайте резервную копию домашнего каталога в <span class=mono>/var/tmp</span> на вашем ближайшем "сервере бэкапов", используя <strong>scp</strong>. Выполните архивирование и сжатие перед началом передачи данных! Подключение к удаленному хосту с помощью <strong>ssh</strong>, распакуйте архив и переместите один файл обратно на свой компьютер, используя <strong>sftp</strong>.</li>
</ul>
<h3>Безопасность</h3>
<ul>
<li>Составьте список открытых (прослушиваемых) портов на вашем компьютере.</li>
<li>Предположим, вы хотите запустить веб-сервер. Какие службы вы бы отключили? Как бы вы это сделали?</li>
<li>Установить доступные обновления.</li>
<li>Как вы можете узнать, кто подключен к вашей системе?</li>
<li>Создайте задание, которое каждый месяц будет напоминать вам изменить пароль и пароль администратора также.</li>
</ul>
  </div>
</div>
    </div>
  </body>
</html>
