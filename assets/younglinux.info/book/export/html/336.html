<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Урок 5. Адреса страниц. Регистрация пользователей и создание ролей</title>
    <base href="" />
    <link type="text/css" rel="stylesheet" href="http://younglinux.info/misc/print.css" />
      </head>
  <body>
              <div class="section-1">
          
    <div id="node-336" class="section-2">
  <h1 class="book-heading">Урок 5. Адреса страниц. Регистрация пользователей и создание ролей</h1>
  <p class="right">Создание сайта на Drupal 6. Практический вводный курс</p>
<h3>Использование модуля Path</h3>
<p>Адреса страниц, которые мы создавали до этого, выглядели так: <span class="blue">доменное_имя/node/№_страницы</span> (например, <span class="blue">developer.home/node/4</span>). Для поисковых роботов это вполне приемлемый адрес, а вот людей он может отталкивать своей неинформативностью. Поэтому лучше, чтобы в адресах страниц был какой-нибудь намек на то, что содержится на данной странице. Например, если на странице речь идет о программировании, то логично, чтобы ее адрес выглядел примерно так: <span class="blue">developer.home/programming</span>.</p>
<p>Для того, чтобы можно было переименовывать адреса страниц, в системе управления содержимым Drupal надо включить модуль Path. После его включения на главной странице управления сайтом появится ссылка <span class="monoi">Синонимы</span> (в разделе <span class="monoi">Конструкция сайта</span>). Задавать собственные имена ссылкам можно здесь, но лучше это делать сразу при создании материала на странице его редактирования.</p>
<p>Перейдите на страницу <span class="monoi">Управление ? Управление содержимым ? Содержимое</span>. Здесь вы должны увидеть созданные вами ранее четыре страницы. Нажмите на ссылку <span class="monoi">Изменить</span> напротив страницы <span class="monoi">О сайте</span>. Откроется форма ее редактирования, где должен появиться новый раздел <span class="monoi">Параметры адреса</span>; раскройте его. В поле следует вписать новое имя страницы. Будьте внимательны, не надо писать полный адрес, <span class="blue">developer.home/</span> следует опустить. Впишите в поле слово about и сохраните изменения. Аналогичным образом переименуйте остальные страницы; задайте для них такие имена - history-programming, property-lang, evolution-lang. Перейдите на какую-нибудь из этих страниц, чтобы убедиться, адрес выглядит теперь иначе.</p>
<p>На самом деле у нас есть еще пара страниц, которые мы не создавали, но Drupal создал их автоматически. Поскольку мы создавали записи в блог, то была сгенерирована страница, где в хронологическом порядке перечисляются все записи в блог от всех пользователей. Ее адрес — <span class="blue">developer.home/blog</span>. Также должны существовать страницы блогов для каждого отдельного пользователя. Перейдите на главную страницу сайта и кликните по ссылке <span class="monoi">Блог пользователя — имя_пользователя</span>. Адрес страницы будет выглядеть следующим образом: <span class="blue">developer.home/blog/1</span>. Давайте переименуем этот адрес со страницы <span class="monoi">Управление ? Синонимы</span>. Нажмите кнопку <span class="monoi">Добавить синоним</span>, далее в поле <span class="monoi">Существующий системный путь</span> напишите <span class="blue">blog/1</span>, а в поле <span class="monoi">Синоним пути</span> — <span class="blue">blog/имя_пользователя</span> (вместо имя_пользователя впишите логин вашего пользователя). Сохраните изменения и перейдите на страницу блога пользователя, чтобы отметить изменения в адресе страницы.</p>
<h3>Пользователи</h3>
<p>Посетители сайта, не зарегистрированные в системе Drupal, называются анонимными пользователями. По умолчанию они не могут оставлять даже комментарии. Чтобы убедиться в этом, достаточно покинуть аккаунт администратора. Если в вашей операционной системе стоит два и более браузеров, то не выходите из аккаунта, а запустите другой браузер и откройте сайт. Здесь вы окажетесь в роли анонимного пользователя.</p>
<p>Разрешим всем посетителям сайта оставлять комментарии, но во избежание спама комментарии должны будут проходть модерацию (т.е. предварительный просмотр администратором сайта). Для этого перейдите на страницу <span class="monoi">Управление ? Управление пользователями ? Разрешения ролей</span>. В столбце <span class="monoi">анонимный пользователь</span> в разделе <span class="monoi">модуль comment</span> проставляем флажки <span class="monoi">иметь доступ к комментариям</span> и <span class="monoi">размещать комментарии</span>, далее сохраняем изменения. Теперь в окне другого браузера (где мы играем роль анонимного пользователя) перезагрузите страницу и оставьте комментарий к любой статье. (Обратите внимание, сначала происходит просмотр комментария, а уже потом его сохранение.) В результате вы получите сообщение, что ваш комментарий был отправлен на проверку, а сам комментарий вы не увидите.</p>
<p>Администратор системы, решивший заняться модерацией новых поступивших комментариев, должен перейти  на страницу <span class="monoi">Управление содержимым ? Комментарии ? Очередь на подтвержение</span>. Здесь каждый комментарий следует просмотреть (ссылка <span class="monoi">изменить</span>). Комментарии, содержащие спам и другие недопустимые вещи, следует удалить, остальные опубликовать. Опубликуйте пока единственный комментарий. В другом браузере перезагрузите страницу и отметьте его появление. </p>
<p>Анонимный пользователь по умолчанию может зарегистрироваться в системе Drupal. Попробуйте сделать это. Перед вами откроется форма, где нужно будет вписать имя и адрес электронной почты. Сайты Drupal, расположенные в Интернет на нормальных хостингах, высылают по почте пароли для пользователей. К сожалению Denwer этого не сделает. Но давайте все равно зарегистрируемся в системе, а пароль подправим со стороны администратора сайта на странице <span class="monoi">Управление пользователями ? Пользователи</span> (надо перейти по ссылке <span class="monoi">изменить</span> и вписать в поле <span class="monoi">Пароль</span> новый пароль). Теперь в другом браузере войдите в систему под только что зарегистрированным пользователем.</p>
<p>Зарегистрированные пользователи могут оставлять комментарии без предварительной модерации. Это не совсем хорошо, т.к. зарегистрироваться в системе может каждый, даже спамер или робот. Обычно с этим борются либо включая модерацию для зарегистрированных пользователей, либо устанавливая так называемую капчу, которая требует, например, при регистрации дополнительных действий от посетителя сайта. На странице <span class="monoi">Управление пользователями ? Разрешения ролей</span> снимите флажок размещать комментарии без проверки для зарегистрированного пользователя. Но и после этого на реально функционирующем сайте лучше ставить капчу, иначе в системе количество эфемерных пользователей будет расти в геометрической прогрессии. Удалять их можно со страницы <span class="monoi">Управление пользователями ? Пользователи</span>. Можно запретить посетителям регистрироваться самостоятельно вообще. Для этого нужно на странице <span class="monoi">Настройка пользователей</span> установить переключатель в позицию Только администраторы могут создавать новые учетные записи пользователей.</p>
<p>Когда регистрация пользователей на сайте не предполагается, бывает лучше отключить блок <span class="monoi">Вход в систему</span>. Отключите его и выйдите из своего аккаунта. Как теперь войти под своим логином на сайт? В CMS Drupal есть специальная страница с формой входа в систему: <span class="blue">домен_сайта/user</span>. Перейдите на эту страницу вашего сайта и войдите в систему через нее.</p>
<h3>Роли</h3>
<p>Посетители (пользователи) сайта могут выступать по отношению к сайту в разных ролях. Пока мы видели только три роли, присутствующие в Drupal по умолчанию. Администратор сайта — это особенная роль, которой позволительно все, что вообще возможно в CMS Drupal. Данная роль может принадлежать лишь одному аккаунту (одному человеку). Зарегистрированных и анонимных пользователей может быть любое количество, между собой они могут различаться своими возможностями (разрешениями) на сайте, которые настраиваются через страницу Разрешения ролей. </p>
<p>Но что делать, если существующих трех ролей недостаточно? Что, если на сайте должны быть как зарегистрированные пользователи, так и особые пользователи, осуществляющие проверку их комментариев и записей (модераторы). Или на сайте может содержаться материал, доступ к которому должен предоставляться только некоторым пользователям. В случае, когда возникают подобные задачи, администратор Drupal может создавать новые роли и назначать им соответствующие права.</p>
<p>Пусть наш сайт будет чем-то вроде многопользовательского блога. Допустим, два программиста ведут личные блоги на одном сайте. Требуется создать специальную роль, которая позволяла бы вести на сайте блог, а также создать пользователей, которым принадлежит эта роль. </p>
<p>Создать новую роль можно на странице <span class="monoi">Управление пользователями ? Роли</span>. Добавьте здесь роль "блогер", далее кликните по ссылке <span class="monoi">изменить права</span>. Разрешите блогеру следующее:</p>
<ul>
<li>создавать записи в блоге</li>
<li>удалять свои записи в блоге</li>
<li>редактировать свои записи в блоге </li>
<li>иметь доступ к комментариям</li>
<li>размещать комментарии без проверки </li>
<li>доступ к содержанию сайта</li>
<li>создание синонимов адресов страниц</li>
<li>иметь доступ к профилям пользователей </li>
<li>изменять свое имя пользователя</li>
</ul>
<p>Поскольку блогеры могут создавать записи, скорее всего, им понадобится HTML-редактор. Поэтому на странице настроек BUEditor следует назначить для роли "блогер" вариант редактора, например, Default.</p>
<p>У нас в системе уже есть один пользователь (помимо администратора) в роли зарегистрированного пользователя. Поменяем ему роль. Для этого на странице <span class="monoi">Пользователи</span> перейдите по ссылке <span class="monoi">изменить</span> напротив его имени. Откоется страница настроек этого пользователя, установите там флажок <span class="monoi">блогер</span> и сохраните изменения.</p>
<p>Теперь поменяем автора у всех ранее опубликованных статей, кроме страницы "О сайте". Пусть администратор сайта только управляет им и размещает информационные страницы, а блоговые записи делают только блогеры. Для этого на странице редактирования каждой статьи в разделе <span class="monoi">Информация об авторе</span> в поле <span class="monoi">Автор</span> впишите имя пользователя-блогера.</p>
<p>Создайте еще одного пользователя-блогера (<span class="monoi">Пользователи ? Добавить пользователя</span>). Зайдите под его аккаунтом и добавьте пару статей, например, "Что такое ядро операционной системы" и "Особенности ядер Unix-подобных операционных систем". Не забудьте назначать адресам страниц синонимы.</p>
  </div>
    </div>
  </body>
</html>
