<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Урок 9. Вставка изображений в статьи. Установка модуля для синтаксической подсветки кода</title>
    <base href="" />
    <link type="text/css" rel="stylesheet" href="http://younglinux.info/misc/print.css" />
      </head>
  <body>
              <div class="section-1">
          
    <div id="node-342" class="section-2">
  <h1 class="book-heading">Урок 9. Вставка изображений в статьи. Установка модуля для синтаксической подсветки кода</h1>
  <p class="right">Создание сайта на Drupal 6. Практический вводный курс</p>
<h3>Способы вставки изображений</h3>
<p>Публикуемые на сайтах статьи могут содержать различные изображения (фотографии, рисунки, скриншоты и т.д.). До сегодняшнего дня мы размещали на сайте лишь текст; рассмотрим, как добавлять в него изображения.</p>
<p>На языке HTML разметка изображения осуществляется тегом img с атрибутом src, у которого в качестве значения используется URL места размещения изображения. Возникает вопрос, где должно находиться изображение: в сети Интернет (на любом другом сайте) или на вашем собственном сайте (хостинге, где размещены файлы сайта)? Когда изображение размещено на других ресурсах, то все достаточно просто: копируем адрес рисунка (чтобы получить адрес изображения, в браузере щелкают по нему правой кнопкой мыши и выбирают <span class="monoi">Свойства изображения</span>) и вставляем его в тег img статьи на своем сайте. Если же мы хотим загрузить изображение на наш сайт, то существует как минимум два варианта: </p>
<ul>
<li>заранее загрузить "вручную" на сайт (например, по протоколу ftp или с помощью модуля upload), затем посмотреть адрес изображения и использовать его при добавлении тега img;</li>
<li>вставлять изображения в момент редактирования статьи, загружая их с помощью специального модуля в файловую структуру CMS Drupal. </li>
</ul>
<p>Второй вариант предпочтительнее, если вы не единственный, кто публикует материалы на сайте. Рассмотрим оба варианта.</p>
<p>Добавьте на ваш сайт от имени любого из блогеров статью, которая содержит два-три  изображения (но пока без них), например, "Цикл While" (13). Первый рисунок (while.png) разместим копированием/перемещением в файловую структуру Drupal; но куда? По логике вещей, если модули и темы, которые загружает администратор сайта, помещаются в каталог <span class="blue">sites/all</span>, то хорошо бы здесь же размещать изображения. Создадим каталог <span class="blue">sites/all/images</span> и переместим сюда один из рисунков. </p>
<p>Теперь откроем статью на редактирование, установим курсор в место, где должно быть это изображение и вставим тег img (можно воспользоваться соответствующей кнопкой BUEditor). Лучше указывать относительный адрес, т.к. в этом случае при смене доменного имени адрес все равно будет правильно указывать на местоположение рисунка. В результате тег должен выглядеть примерно так:</p>
<p><span class="geshifilter"><code class="python geshifilter-python"><span style="color: #66cc66;">&lt;</span>img src=<span style="color: #483d8b;">&quot;sites/all/images/while.png&quot;</span> width=<span style="color: #483d8b;">&quot;605&quot;</span> height=<span style="color: #483d8b;">&quot;209&quot;</span> alt=<span style="color: #483d8b;">&quot;Цикл While&quot;</span> /<span style="color: #66cc66;">&gt;</span></code></span></p>
<p>Когда вы сохраните статью после редактирования, то не увидите изображения, т.к. <span class="geshifilter"><code class="python geshifilter-python"><span style="color: #66cc66;">&lt;</span>img<span style="color: #66cc66;">&gt;</span></code></span> не является допустимым тегом для формата ввода Filtered HTML. Добавьте <span class="geshifilter"><code class="python geshifilter-python"><span style="color: #66cc66;">&lt;</span>img<span style="color: #66cc66;">&gt;</span></code></span> в настройках этого фильтра. </p>
<p>Второе изображение будем добавлять с помощью специального модуля — IMCE. Загрузите его с сайта <span class="blue">drupal.org</span> и распакуйте в каталог <span class="blue">sites/all/modules</span>, после чего включите на странице Модули CMS Drupal. На странице <span class="monoi">Настройка сайта ? IMCE</span> назначьте для роли "блогер" профиль User-1. Теперь зайдем на сайт под блогером и попробуем вставить в статью второе изображение.</p>
<p>Нажмите на кнопку вставки изображения редактора BUEditor, там должна появиться кнопка <span class="monoi">Browse</span>. Нажмите ее, откроется окно файлового браузера IMCE. IMCE настроен так, что  открывает просмотр каталога <span class="blue">sites/default/files/</span>, куда многие модули сохраняют сгенерированные и загруженные с их помощью файлы. Конечно, лучше если администратор создаст здесь дополнительный каталог и настроит IMCE так, чтобы открывался именно он.</p>
<p>Для загрузки изображения в окне IMCE следует нажать кнопку <span class="monoi">Загрузить</span>, выбрать и загрузить изображение. После этого изображение появиться в основном окне IMCE, надо выделить его и нажать кнопку <span class="monoi">Send to editor</span>.</p>
<h3>Установка и использование GeSHi</h3>
<p>На сайте, который мы создаем, некоторые статьи содержат примеры программного исходного кода. Код принято помещать в контейнер тега code. Внешний вид, который принимает исходный код после этого, зависит от применяемого к нему стиля CSS. Если вы посмотрите на любую статью сайта на Drupal, содержащую пример исходного кода, то заметите, что шрифт внутри тега code отличается от основного шрифта. Т.е. сама тема CMS имеет описание стиля для этого тега. Несмотря на это есть ряд проблем. Исходный код легче читается, если выполнена его синтаксическая подсветка. Реализовывать это только с помощью языков HTML и CSS весьма трудоемкая задача. В исходном коде бывает важным наличие отступов от левого края строки. Например, в языке программирования Python отступы имеют синтаксический смысл. Как мы видим, тег code их не интерпретирует.</p>
<p>Проблему можно решить с помощью установки специального модуля, который отвечает за то, как отображается содержимое контейнера code. В системе Drupal широко используется модуль GeSHi Filter for syntax highlighting. Этот модуль позволяет использовать библиотеку GeSHi, которая должна быть также загружена в файловую структуру CMS Drupal.</p>
<p>Загрузите с сайта <span class="blue">drupal.org</span> модуль GeSHi Filter for syntax highlighting и распакуйте его в каталог <span class="blue">sites/all/modules</span>. C <span class="blue">sourceforge.net/projects/geshi/files/geshi/</span> загрузите саму библиотеку. Каталог geshi (библиотека) должен быть помещен внутрь каталога модуля geshifilter.</p>
<p>Откройте страницу <span class="monoi">Модули</span> сайта и включите только модуль Geshi Filter (GeSHi field и GeSHi node нам пока не нужны). Теперь его нужно настроить на странице <span class="monoi">Настройка сайта ? GeSHi Filter</span>. Здесь в поле <span class="monoi">Generic syntax highlighting tags</span> содержатся теги, которые будут "обрабатываться" модулем GeSHi Filter. В поле <span class="monoi">Default highlighting mode</span> (вариант подсветки по умолчанию) следует выбрать язык программирования, для которого будет выполняться подсветка синтаксиса, если используется тег code (или любой другой из указанных в поле <span class="monoi">Generic syntax highlighting tags</span>) без каких-либо атрибутов. Когда необходимый язык отсутствуют, то его можно включить на странице <span class="monoi">Настройка сайта ? GeSHi Filter ? Языки ? Отключено</span>. Перейдите на эту страницу и включите Pascal, после чего на странице <span class="monoi">Включено</span> пропишите тег для этого языка (<br />
<pascal>). Но на странице общих настроек GeSHi filter выберите в качестве варианта подсветки по умолчанию язык программирования Python и сохраните изменения.</pascal></p>
<p>Если вы теперь посмотрите на ранее созданную статью, содержащую тег code, то не увидите изменений. Дело в том, что для формата ввода Filtered HTML не включен фильтр GeSHi filter. Исправить этот недочет можно на странице <span class="monoi">Настройка сайта ? Форматы ввода ? Filtered HTML</span>. После этого подсветка кода сработает.</p>
<p>Когда в тексте статьи вам потребуется подсветка синтаксиса отличная от установленной по умолчанию, вместо тега <span class="geshifilter"><code class="python geshifilter-python"><span style="color: #66cc66;">&lt;</span>code<span style="color: #66cc66;">&gt;</span></code></span> следует прописать тег для требуемого языка (например, <span class="geshifilter"><code class="python geshifilter-python"><span style="color: #66cc66;">&lt;</span>pascal<span style="color: #66cc66;">&gt;</span></code></span>). При этом язык программирования должен быть предварительно включен на странице настроек GeSHi filter.</p>
  </div>
    </div>
  </body>
</html>
