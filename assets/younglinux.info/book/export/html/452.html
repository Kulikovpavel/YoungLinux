<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Проект &quot;Оценка возможностей CMS Drupal для создания сайта-сервиса по сборке ПК&quot;</title>
    <base href="" />
    <link type="text/css" rel="stylesheet" href="http://younglinux.info/misc/print.css" />
      </head>
  <body>
        
    <div id="node-452" class="section-1">
  <h1 class="book-heading">Проект &quot;Оценка возможностей CMS Drupal для создания сайта-сервиса по сборке ПК&quot;</h1>
  <h4>Аннотация</h4>
<p>Целью данной работы было исследование и оценка возможностей CMS Drupal, в результате чего можно было бы дать заключение, можно ли с помощью данной системы создать сайт для помощи при сборке персонального компьютера. </p>
<p>Сайт-сервис должен был бы предлагать посетителю возможность удобного просмотра сборок ПК разного назначения (офисного, игрового и др.). Должна быть предусмотрена сортировка и фильтрация сборок по различным характеристикам. Посетитель сайта должен иметь возможность создавать собственные сборки, чтобы выяснить подходят ли комплектующие, соответствует ли сборка назначению. Пользователи должны иметь возможность голосовать за сборки и оставлять комментарии. </p>
<p>В результате выполнения данной работы удалось реализовать часть планируемых задач. При этом были изучены две версии CMS Drupal (6 и 7), около десятка модулей, создано несколько вариантов структуры сайта. Был сделан вывод: несмотря на то, что Drupal позиционируется как гибкая система, создать узко-специализированный проект лишь подбором различных модулей невозможно. Одним из решений может быть разработка собственных модулей. Кроме того, в результате выполнения исследования открылась еще одна проблема — разработка базы данных комплектующих таким образом, чтобы установить между ними связь по совместимости.</p>
  <div id="node-453" class="section-2">
  <h1 class="book-heading">Описание проекта &quot;Оценка возможностей CMS Drupal для создания сайта-сервиса по сборке ПК&quot;</h1>
  <h3>Цели и задачи</h3>
<p>Многие люди хотят не просто купить компьютер, а собрать его самостоятельно из комплектующих. На некоторых форумах (например, http://www.cyberforum.ru/computer-config/ ) люди часто спрашивают, какие компоненты подобрать для ПК, предназначенного для определенной цели. Многие составляют сборки и просят их оценить и прокомментировать остальных участников форума. Появилась идея создать сайт помощи сборки ПК. Что значит «собрать» компьютер в данном случае:</p>
<ul>
<li>Во-первых, подобрать комплектующие по совместимости.</li>
<li>«Производительность» сборки должна соответствовать будущему назначению компьютера. Например, если ПК будет предназначен для офисных работ, то не следует собирать мощный и дорогой компьютер.</li>
</ul>
<p>Система управления контентом (CMS – content management system) Drupal позиционируется как гибкий «продукт» для создания сайтов. Под гибкостью понимается то, что с его помощью можно создавать различные по структуре и назначению сайты, а не однотипные (как, например, Wordpress, позиционирующий себя преимущественно как CMS для блогов). Гибкость Drupal обеспечивается тем, что есть ядро системы, включающее немногочисленный ряд основных (стандартных) модулей, и есть огромное множество модулей, расширяющих функциональность системы. В зависимости от того, какие модули подключены можно получать различные сайты.</p>
<p><strong>Целью работы</strong> было выяснить, можно ли, используя Drupal и подбирая различные модули, создать сайт-сервис «сборки» ПК. Или получить такой узко-специализированный сайт на Drupal нельзя и единственным вариантом является написание собственной CMS.</p>
<p>	Перед тем как искать модули и их комбинации надо точно определиться с тем, что мы хотим получить, и как это будет выглядеть. В идеальном варианте – это может выглядеть так:</p>
<ol>
<li>Человек заходит на сайт с целью подобрать конфигурацию компьютера.</li>
<li>Он может посмотреть ранее созданные другими пользователями сборки. Отсортировать и отфильтровать их по разным признакам, выбрав подходящие. Т.е. на сайте необходимо предусмотреть удобную и всестороннюю фильтрацию и сортировку материала.</li>
<li>Предыдущие сборки могут быть качественными или нет. Посетители должны иметь возможность не только их комментировать, но и выставлять оценку (соответствует ли сборка целям и цене). Человек, зашедший на сайт, должен видеть наиболее удачные сборки. Т.е. необходимо предусмотреть рейтинг и сортировку сборок по нему. Запрограммировать автоматическую оценку сборки достаточно сложная задача, поэтому не рассматривается.</li>
<li>Если пользователь не находит подходящей сборки или у него есть свой вариант, который он хочет оценить, то он может создать ноду (статью определенного типа (материала)), где в форме ему предлагается заполнить поля (процессор, материнская плата и др.).</li>
<li>При заполнении полей хорошо бы, чтобы пользователь не мог ввести несовместимые комплектующие. Например, если он вводит процессор с сокетом LGA1155, то не сможет ввести материнскую плату с другим. </li>
<li>Как пользователь будет вводить комплектующие? Понятно, что это должны быть названия устройств, которые стандартизированы. Если человек будет вводить их вручную, то может ввести не так как надо. Хорошо бы было, чтобы он не вводил, а выбирал устройства из существующих. Для этого надо иметь API доступа к базам данных крупных ресурсов (например, Amazon, Яндекс-Маркет). </li>
</ol>
<p>Итак, «сервис» сайта заключается, во-первых, в возможности поиска подходящих сборок среди ранее созданных по различным критериям, а во-вторых – в автоматизированной помощи при составлении сборки.</p>
<p>Следует дополнительно отметить, что человек может указывать не все компоненты, во-вторых - хорошо бы, чтобы автоматически считалась сумма сборки.</p>
<p><span class="monoi">Примечание:</span><br />
Материал – тип статьи, нода – отдельно взятая статья (конкретная сборка).</p>
<h3>Реализация фильтрации и сортировки</h3>
<p>Допустим, у нас на сайте есть 500 нод типа «Сборка компьютера». В каждой ноде указаны или не указаны: процессор, материнская плата, жесткий диск, видеокарта и др, назначение сборки, цена сборки, ее рейтинг. Человек может захотеть отфильтровать только те сборки, в которых используется процессор модельного ряда Intel Core i5, или только те, цена которых лежит в пределах от 15 до 20 тыс. рублей, или посмотреть только «игровые» сборки. </p>
<p>Модуль Views позволяет это сделать. Он создает различные коллекции статей, объединенных по тем или иным признакам, и представляет коллекции как отдельные страницы. При этом фильтрацию и сортировку можно включить так, чтобы ее выполнял посетитель сайта.</p>
<p>В состав ядра Drupal входят такие модули как Таксономия (Taxonomy) и Подшивка (Book). Оба позволяют относить статью к категориям. Однако ноду нельзя отнести к двум подшивкам (категориям) одновременно, а к терминам таксономии можно. Можно создать несколько словарей: «сокеты», «модель процессора», «производитель материнской платы», «назначение компьютера» [Приложение 1]. Однако человек может указать неверную категорию при создании ноды, кроме того, для него это лишняя работа, если он указывает название процессора, то его сокет и модельный ряд уже указаны. Конечно, можно было бы создать словари, содержащие все существующие комплектующие, но это трудоемкая задача, т.к., например, только количество существующих на данный момент в продаже процессоров более 100 моделей, а материнских плат более 1500.<br />
<img src="../../../img/projects/drupal1.jpg" alt="Таксономия в Drupal" /></p>
<p>Модули CCK позволяет решить данную задачу более элегантно. CCK позволяет добавлять поля различного типа в форму материала.  Можно создать поля, куда человек будет вставлять названия комплектующих и их цену [Приложения 2, 3, 4]. Далее с помощью модуля Views можно сформировать различные представления [Приложения 5, 6]:</p>
<ul>
<li>все существующие сборки с возможностью сортировки по ряду характеристик,</li>
<li>полные сборки (содержат процессор, м. плату, диск, ОЗУ, корпус, блок питания),</li>
<li>входящие в определенный ценовой диапазон,</li>
<li>обязательно содержащие процессор и материнскую плату,</li>
<li>определенного производителя процессора,</li>
<li>фильтр, где пользователь сам выбирает характеристики.</li>
</ul>
<p><img src="../../../img/projects/drupal2.png" alt="Настройка полей материала в Drupal" /><br />
<hr />
<img src="../../../img/projects/drupal3.png" alt="Редактирование материала в Drupal" /><br />
<hr />
<img src="../../../img/projects/drupal4.png" alt="Внешний вид ноды в Drupal" /><br />
<hr />
<img src="../../../img/projects/drupal5.png" alt="Создание вида в Drupal" /><br />
<hr />
<img src="../../../img/projects/drupal6.png" alt="Готовое представление с возможностью сортировки в Drupal" /><br />
<hr />
<img src="../../../img/projects/drupal6b.png" alt="Фильтрация" /><br />
Особенно следует отметить модуль Ubercart, который предназначен для создания онлайн-магазинов. Его существенная часть отвечает за каталогизацию нод по различным признакам и удобному представлению. К сожалению, по умолчанию форма материала имеет много лишнего, ориентированного на продажу [Приложение 7], сам модуль Ubercart очень большой и сложный. Необходима его настройка и редактирование формы материала, также нет такой гибкости в представлении материала, который дает связка CCK + Views.<br />
<img src="../../../img/projects/drupal7.jpg" alt="Ubercart" /></p>
<h3>Рейтинг</h3>
<p>	Для Drupal существует ряд различных модулей, позволяющих добавлять рейтинги. Один из них Fivestar. Он позволяет добавлять рейтинги к материалу и комментариям. Однако он различается между Drupal 6 и Drupal 7. В Drupal 6 можно включить рейтинг для материала так, чтобы голосовали пользователи сайта. Однако специального поля при этом не создается, поэтому во Views нельзя задать отображение рейтинга статей в формируемой коллекции. Если же к материалу добавить поле Fivestar (и со Views проблема будет решена), то голосовать может только при создании статьи, что не подходит для идеи проекта. В рейтинг комментариев в Drupal 6 заложена следующая идея: каждый комментатор выставляет оценку статье, она отображается в комментарии, а на статье отображается средний рейтинг по комментариям.</p>
<p>	В Drupal 7 модуль Fivestar дает немного другую функциональность. Здесь единственный способ добавить рейтинг к материалу — это создать поле Fivestar. Поэтому проблема с модулем Views решена изначально. Это поле можно настроить так, что голосовать будут именно посетители, а не тот, кто создает конфигурацию компьютера. Также в Drupal 7 к комментариям может быть привязан отдельный рейтинг, не связанный с нодой. Это больше подходит к нашему проекту. Однако модуль Fivestar для ветки Drupal 7 на данный момент существует в версии «alpha», поэтому некоторые дополнительные настройки отсутствуют, например, нет возможности писать, что значат уровни рейтинга.</p>
<h3>Поиск модуля, ограничивающего ввод в поле в зависимости от того, что содержится в другом поле</h3>
<p>	Необходимо, чтобы человек при создании материала «Сборка компьютера» не мог, например, ввести в поля «Процессор» и «Материнская плата» несовместимые комплектующие, не мог указать блок питания на 350 W, если указал мощный процессор.</p>
<p>	К сожалению, в названиях комплектующих не всегда отражены характеристики, определяющие совместимость. Поэтому, пришлось бы в форму материала «Сборка компьютера» добавлять дополнительные поля-описания комплектующих и уже потом указывать их совместимость с помощью какого-либо модуля. Такой вариант материала рассматривался, однако форма получилась слишком большой (не каждый пользователь станет ее заполнять). И самое главное, не удалось найти модуля, который бы устанавливал требуемые зависимости между полями. Кроме того, эти зависимости слишком разные.</p>
<p>	Хотелось бы отметить модуль Conditional Fields. Он позволяет скрывать/отображать поля в зависимости от значения других полей (которые должны иметь тип «флажки» или «радиокнопки»). С его помощью в Drupal 6 был создан такой вариант: при создании материала можно выбрать, какие компоненты сборки будут указаны и только после этого появятся группы полей для этих компонентов, остальные поля будут скрыты [Приложение 8]. Это удобно не столько при создании материала, сколько при формировании вида, когда к виду можно добавить поле, в котором видно сколько компонентов используется в сборке. Однако данный модуль для Drupal 7 существует в состоянии «dev» (версия для разработчиков). Хотя модуль работает, нет возможности настроить скрытие/отображение для групп, а не отдельных полей. Это минус, которые уничтожает все плюсы использования этого модуля.<br />
<img src="../../../img/projects/drupal8.png" alt="Использование модуля Conditional Fields" /></p>
<h3>Использование баз данных сторонних ресурсов</h3>
<p>	Хорошо бы ограничить ввод в поле только теми устройствами, которые существуют. </p>
<p>	Яндекс.Маркет имеет API, позволяющий сайтам получать сведения о товарах. Однако ключ к нему можно получить, лишь описав проект, указав его адрес и количество посетителей. Также для Drupal отсутствует модуль использования API Яндекс.Маркета так, чтобы можно было импортировать на сайт сведения о товарах.</p>
<p>	Модуль Amazon предоставляет доступ к информации о товарах, размещенных на http://amazon.com. Обычные поля в форме материала «Сборка компьютера» можно заменить на Amazon field, которые ограничат ввод пользователя только товарами, которые присутствуют на сайте Амазона (можно настроить ввод как названия товар или его номер — ASIN). Помимо этого можно настроить, как будут выглядеть товары в готовой ноде (будут ли там изображения, краткое описание и др.). В результате статьи получаются более красочными, но на английском [Приложение 9]. Однако вряд ли Amazon.com содержит все существующие комплектующие.<br />
<img src="../../../img/projects/drupal9.png" alt="Модуль Amazon, автодополнение" /><br />
<hr />
<img src="../../../img/projects/drupal9b.png" alt="Внешний вид статьи с использованием модуля Amazon" /></p>
<p>	Можно решить проблему, если на сайте Амазона нет необходимых комплектующих следующим образом. Создать на сайте два материала «Сборка компьютера» и «Сборка компьютера (Amazon)».  В первой ввод комплектующих в поля будет осуществляться вручную, а во второй — с помощью Amazon field. Человек сам выберет, что ему подходит. Однако в таком случае появляется проблема с созданием общих видов (модуль Views) для двух материалов, т.к. появляется в два раза больше полей. Решить ее можно только лишь создав отдельные виды для каждого материала.</p>
<h3>Другой вариант сайта</h3>
<p>	Можно было бы создать сайт-сервис по-другому. Если создать собственную базу данных комплектующих, установить между ними зависимости, то часть проблем бы решилась (значения уже не вводятся в поля, а выбираются из списка; например, после выбора процессора появляется список лишь подходящих материнских плат). Как было сказано раньше, это сложно из-за большого количества комплектующих и множества зависимостей. </p>
<p>	Одним из решений может быть — предоставить пользователю самому добавлять комплектующие, если их описания нет на сайте, перед тем как создавать ноду материала «Сборка компьютера». </p>
<p>	Еще одна полезная особенность, если на сайте будут материалы-комплектующие и выбор будет происходить из них. Можно использовать подмодуль CCK Node Reference, позволяющий ссылаться на материал компонента. При этом материал «Сборка компьютера» можно настроить так, чтобы при щелчке по компоненту, открывалась не его страница, а данные появлялись на текущей странице. Т.е. пользователь сразу может смотреть не только сборку, но и подробную информацию по комплектующим.</p>
<h3>Выводы</h3>
<p>	В результате изучения CMS Drupal версий 6 и 7 и ряда их модулей пришли к следующему:</p>
<ul>
<li>проект можно частично реализовать разными способами;</li>
<li>полная реализация возможна, скорее всего, лишь при создании собственной базы данных комплектующих, разработка и заполнение которой может быть расценено как отдельный проект;</li>
<li>при этом потребуется самим разработать некоторые модули для Drupal;</li>
<li>получился не столько сайт-сервис, сколько многопользовательский блог.</li>
</ul>
<p>	На данный момент пришли к следующему рабочему варианту сайта по сборке ПК:</p>
<ol>
<li>Используемая версия и модули: Drupal 7, CCK, Views, Tracker (позволяет отслеживать последние изменения на сайте), Computed Field (подсчет суммы сборки), Fieldgroup (объединение полей в группы), Fivestar, CSS Injector (корректировка вида ноды), возможно Amazon.</li>
<li>Зарегистрированный пользователь может оставлять комментарии, создавать ноды «Сборка компьютера», участвовать в голосовании.</li>
<li>Форма материала «Сборка компьютера» содержит десять групп: «Процессор», «Кулер для процессора», «Материнская плата» и др. Каждая группа включает два поля: «Название» и «Цена». Ни одно из полей не является обязательным к заполнению. Помимо групп форма содержит поле Computed, где автоматически подсчитывается сумма сборки, исходя из значений в полях «Цена». Поле Fivestar в состоянии «rated while viewing», так что голосовать можно при просмотре материала. Поле-радиокнопки и обычное поле «Назначение компьютера», многострочное поле для вопросов и замечаний того, кто создает ноду.</li>
<li>Таким образом пользователь может не «собирать» компьютер, а задать вопрос, как ему лучше собрать компьютер под те или иные цели.</li>
<li>Несколько коллекций нод, созданных с помощью Views, по разным признакам. </li>
<li>По возможности ввести второй материал «Сборка компьютера (Amazon)».</li>
</ol>
<h3>Литература и информационные источники</h3>
<ol>
<li>Байрон А. и др. Drupal: создание и управление сайтом. - СПб.: Символ-Плюс, 2010. - 567 с., ил.</li>
<li>Басси С. Начинаем работать с Drupal: полное практическое руководство. - PDF — 2010 г.</li>
<li>http://drupal.org</li>
<li>http://drupal.ru</li>
</ol>
  </div>
</div>
    
  </body>
</html>
